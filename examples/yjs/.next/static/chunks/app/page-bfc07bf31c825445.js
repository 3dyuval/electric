(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6775:function(e,t,s){Promise.resolve().then(s.bind(s,9426))},9426:function(e,t,s){"use strict";s.d(t,{default:function(){return ts}});var i,n,r,a,o,l,h,c,u,d,f,p,m,w,v,y,g,b,S,k,O,E,P,W,j,x,M,_,A,H,L,N,C,U,R=s(7112),D=s(3688),I=s(3631),T=s(8431),q=s(993),F=s(5558),J=s(3271),V=s(1737),z=s(4250),G=s(6751),B=s(2665),$=s(2119),Q=Object.defineProperty,X=Object.defineProperties,Y=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,et=e=>{throw TypeError(e)},es=(e,t,s)=>t in e?Q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ei=(e,t)=>{for(var s in t||(t={}))Z.call(t,s)&&es(e,s,t[s]);if(K)for(var s of K(t))ee.call(t,s)&&es(e,s,t[s]);return e},en=(e,t)=>X(e,Y(t)),er=(e,t)=>{var s={};for(var i in e)Z.call(e,i)&&0>t.indexOf(i)&&(s[i]=e[i]);if(null!=e&&K)for(var i of K(e))0>t.indexOf(i)&&ee.call(e,i)&&(s[i]=e[i]);return s},ea=(e,t,s)=>t.has(e)||et("Cannot "+s),eo=(e,t,s)=>(ea(e,t,"read from private field"),s?s.call(e):t.get(e)),el=(e,t,s)=>t.has(e)?et("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),eh=(e,t,s,i)=>(ea(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),ec=(e,t,s)=>(ea(e,t,"access private method"),s),eu=(e,t,s)=>new Promise((i,n)=>{var r=e=>{try{o(s.next(e))}catch(e){n(e)}},a=e=>{try{o(s.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,a);o((s=s.apply(e,t)).next())}),ed=class e extends Error{static fromResponse(t,s){return eu(this,null,function*(){let i,n;let r=t.status,a=Object.fromEntries([...t.headers.entries()]),o=t.headers.get("content-type");return o&&o.includes("application/json")?n=yield t.json():i=yield t.text(),new e(r,i,n,a,s)})}constructor(e,t,s,i,n,r){super(r||"HTTP Error ".concat(e," at ").concat(n,": ").concat(null!=t?t:JSON.stringify(s))),this.url=n,this.name="FetchError",this.status=e,this.text=t,this.json=s,this.headers=i}},ef=class extends Error{constructor(){super("Fetch with backoff aborted"),this.name="FetchBackoffAbortError"}},ep=class extends Error{constructor(){super("Invalid shape options: missing required url parameter"),this.name="MissingShapeUrlError"}},em=class extends Error{constructor(){super("Invalid signal option. It must be an instance of AbortSignal."),this.name="InvalidSignalError"}},ew=class extends Error{constructor(){super("shapeHandle is required if this isn't an initial fetch (i.e. offset > -1)"),this.name="MissingShapeHandleError"}},ev=class extends Error{constructor(e){super("Cannot use reserved Electric parameter names in custom params: ".concat(e.join(", "))),this.name="ReservedParamError"}},ey=class extends Error{constructor(e){super('Column "'.concat(null!=e?e:"unknown",'" does not allow NULL values')),this.name="ParserNullValueError"}},eg=class extends Error{constructor(e,t){let s="The response for the shape request to ".concat(e," didn't include the following required headers:\n");t.forEach(e=>{s+="- ".concat(e,"\n")}),super(s+="\nThis is often due to a proxy not setting CORS correctly so that all Electric headers can be read by the client.\nFor more information visit the troubleshooting guide: /docs/guides/troubleshooting/missing-headers")}},eb=e=>Number(e),eS=e=>JSON.parse(e),ek=e=>e,eO={int2:eb,int4:eb,int8:e=>BigInt(e),bool:e=>"true"===e||"t"===e,float4:eb,float8:eb,json:eS,jsonb:eS},eE=class{parse(e,t){return JSON.parse(e,(e,s)=>(("value"===e||"old_value"===e)&&"object"==typeof s&&null!==s&&Object.keys(s).forEach(e=>{s[e]=this.parseRow(e,s[e],t)}),s))}parseRow(e,t,s){var i;let n=s[e];if(!n)return t;let{type:r,dims:a}=n,o=er(n,["type","dims"]),l=eP(null!=(i=this.parser[r])?i:ek,n,e);return a&&a>0?eP((e,t)=>{let s,i,n,r,a,o;return s=0,i=null,n="",r=!1,a=0,function e(t){let h=[];for(;s<t.length;s++){if(i=t[s],r)"\\"===i?n+=t[++s]:'"'===i?(h.push(l?l(n):n),n="",r='"'===t[s+1],a=s+2):n+=i;else if('"'===i)r=!0;else if("{"===i)a=++s,h.push(e(t));else if("}"===i){r=!1,a<s&&h.push(l?l(t.slice(a,s)):t.slice(a,s)),a=s+1;break}else","===i&&"}"!==o&&'"'!==o&&(h.push(l?l(t.slice(a,s)):t.slice(a,s)),a=s+1);o=i}return a<s&&h.push(l?l(t.slice(a,s+1)):t.slice(a,s+1)),h}(e)[0]},n,e)(t):l(t,o)}constructor(e){this.parser=ei(ei({},eO),e)}};function eP(e,t,s){var i;let n=!(null!=(i=t.not_null)&&i);return i=>{if(null===i||"NULL"===i){if(!n)throw new ey(null!=s?s:"unknown");return null}return e(i,t)}}function eW(e){return"key"in e}var ej="electric-handle",ex="electric-offset",eM="cursor",e_="handle",eA="live",eH="offset",eL="force-disconnect-and-refresh",eN=[429],eC={initialDelay:100,maxDelay:1e4,multiplier:1.3},eU={maxChunksToPrefetch:2},eR=["electric-offset","electric-handle"],eD=["electric-cursor"],eI=["electric-schema"],eT=class{abort(){eo(this,r).forEach(e=>{let[t,s]=e;return s.abort()})}consume(){for(var e,t=arguments.length,s=Array(t),i=0;i<t;i++)s[i]=arguments[i];let n=s[0].toString(),c=null==(e=eo(this,r).get(n))?void 0:e[0];if(c&&n===eo(this,a))return eo(this,r).delete(n),c.then(e=>{let t=eq(n,e);eh(this,a,t),eo(this,o)&&!eo(this,r).has(eo(this,o))&&ec(this,l,h).call(this,eo(this,o),s[1])}).catch(()=>{}),c}constructor(e){var t;el(this,l),el(this,i),el(this,n),el(this,r,new Map),el(this,a),el(this,o),eh(this,i,null!=(t=e.fetchClient)?t:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return fetch(...t)}),eh(this,n,e.maxPrefetchedRequests),eh(this,a,e.url.toString()),eh(this,o,eo(this,a)),ec(this,l,h).call(this,e.url,e.requestInit)}};function eq(e,t){let s=t.headers.get(ej),i=t.headers.get(ex),n=t.headers.has("electric-up-to-date");if(!s||!i||n)return;let r=new URL(e);if(!r.searchParams.has(eA))return r.searchParams.set(e_,s),r.searchParams.set(eH,i),r.searchParams.sort(),r.toString()}function eF(){}i=new WeakMap,n=new WeakMap,r=new WeakMap,a=new WeakMap,o=new WeakMap,l=new WeakSet,h=function(){for(var e,t,s=arguments.length,a=Array(s),c=0;c<s;c++)a[c]=arguments[c];let u=a[0].toString();if(eo(this,r).size>=eo(this,n))return;let d=new AbortController;try{let{signal:s,cleanup:n}=function(e,t){let s=eF;if(t){if(t.aborted)e.abort();else{let i=()=>e.abort();t.addEventListener("abort",i,{once:!0,signal:e.signal}),s=()=>t.removeEventListener("abort",i)}}return{signal:e.signal,cleanup:s}}(d,null==(e=a[1])?void 0:e.signal),c=eo(this,i).call(this,u,en(ei({},null!=(t=a[1])?t:{}),{signal:s}));eo(this,r).set(u,[c,d]),c.then(e=>{if(!e.ok||d.signal.aborted)return;let t=eq(u,e);if(!t||t===u){eh(this,o,void 0);return}return eh(this,o,t),ec(this,l,h).call(this,t,a[1])}).catch(()=>{}).finally(n)}catch(e){}};var eJ=new Set([eM,e_,eA,eH]);function eV(e){return eu(this,null,function*(){return"function"==typeof e?e():e})}var ez=class{get shapeHandle(){return eo(this,b)}get error(){return eo(this,c)}get isUpToDate(){return eo(this,y)}get lastOffset(){return eo(this,m)}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},s=Math.random();return eo(this,f).set(s,[e,t]),eo(this,p)||ec(this,x,M).call(this),()=>{eo(this,f).delete(s)}}unsubscribeAll(){eo(this,f).clear()}lastSyncedAt(){return eo(this,v)}lastSynced(){return void 0===eo(this,v)?1/0:Date.now()-eo(this,v)}isConnected(){return eo(this,g)}isLoading(){return!eo(this,y)}hasStarted(){return eo(this,p)}forceDisconnectAndRefresh(){return eu(this,null,function*(){var e,t;eh(this,E,!0),!eo(this,y)||(null==(e=eo(this,O))?void 0:e.signal.aborted)||null==(t=eo(this,O))||t.abort(eL),yield ec(this,x,_).call(this),eh(this,E,!1)})}constructor(e){var t,s,i;el(this,x),el(this,c,null),el(this,u),el(this,d),el(this,f,new Map),el(this,p,!1),el(this,m),el(this,w),el(this,v),el(this,y,!1),el(this,g,!1),el(this,b),el(this,S),el(this,k),el(this,O),el(this,E,!1),el(this,P),el(this,W),el(this,j),this.options=ei({subscribe:!0},e),function(e){if(!e.url)throw new ep;if(e.signal&&!(e.signal instanceof AbortSignal))throw new em;if(void 0!==e.offset&&"-1"!==e.offset&&!e.handle)throw new ew;eG(e.params)}(this.options),eh(this,m,null!=(t=this.options.offset)?t:"-1"),eh(this,w,""),eh(this,b,this.options.handle),eh(this,d,new eE(e.parser)),eh(this,k,this.options.onError);let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eC;var s=this;let{initialDelay:i,maxDelay:n,multiplier:r,debug:a=!1,onFailedAttempt:o}=t;return function(){for(var t=arguments.length,l=Array(t),h=0;h<t;h++)l[h]=arguments[h];return eu(s,null,function*(){var t;let s=l[0],h=l[1],c=i,u=0;for(;;)try{let t=yield e(...l);if(t.ok)return t;throw yield ed.fromResponse(t,s.toString())}catch(e){if(null==o||o(),null==(t=null==h?void 0:h.signal)?void 0:t.aborted)throw new ef;if(e instanceof ed&&!eN.includes(e.status)&&e.status>=400&&e.status<500)throw e;yield new Promise(e=>setTimeout(e,c)),c=Math.min(c*r,n),a&&(u++,console.log("Retry attempt #".concat(u," after ").concat(c,"ms")))}})}}(null!=(s=e.fetchClient)?s:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return fetch(...t)},en(ei({},null!=(i=e.backoffOptions)?i:eC),{onFailedAttempt:()=>{var t,s;eh(this,g,!1),null==(s=null==(t=e.backoffOptions)?void 0:t.onFailedAttempt)||s.call(t)}}));eh(this,u,function(e){var t=this;return function(){for(var s=arguments.length,i=Array(s),n=0;n<s;n++)i[n]=arguments[n];return eu(t,null,function*(){let t=yield e(...i);if(t.ok){let e=t.headers,s=[],n=t=>s.push(...t.filter(t=>!e.has(t)));n(eR);let r=i[0].toString(),a=new URL(r);if("true"===a.searchParams.get(eA)&&n(eD),a.searchParams.has(eA)&&"false"!==a.searchParams.get(eA)||n(eI),s.length>0)throw new eg(r,s)}return t})}}(function(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eU;var i=this;let{maxChunksToPrefetch:n}=s;return function(){for(var s=arguments.length,r=Array(s),a=0;a<s;a++)r[a]=arguments[a];return eu(i,null,function*(){let s=r[0].toString(),i=null==t?void 0:t.consume(...r);if(i)return i;null==t||t.abort();let a=yield e(...r),o=eq(s,a);return o&&(t=new eT({fetchClient:e,maxPrefetchedRequests:n,url:o,requestInit:r[1]})),a})}}(n)))}};function eG(e){if(!e)return;let t=Object.keys(e).filter(e=>eJ.has(e));if(t.length>0)throw new ev(t)}function eB(e,t,s){if(void 0!==s&&null!=s){if("string"==typeof s)e.searchParams.set(t,s);else if("object"==typeof s)for(let[i,n]of Object.entries(s))e.searchParams.set("".concat(t,"[").concat(i,"]"),n);else e.searchParams.set(t,s.toString())}}c=new WeakMap,u=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,v=new WeakMap,y=new WeakMap,g=new WeakMap,b=new WeakMap,S=new WeakMap,k=new WeakMap,O=new WeakMap,E=new WeakMap,P=new WeakMap,W=new WeakMap,j=new WeakMap,x=new WeakSet,M=function(){return eu(this,null,function*(){var e,t,s,i,n,r,a;if(eo(this,p))throw Error("Cannot start stream twice");eh(this,p,!0);try{for(;!(null==(e=this.options.signal)?void 0:e.aborted)&&!eo(this,y)||this.options.subscribe;){let e,n;let{url:o,signal:l}=this.options,[h,c]=yield Promise.all([function(e){return eu(this,null,function*(){if(!e)return{};let t=Object.entries(e);return Object.fromEntries((yield Promise.all(t.map(e=>eu(this,[e],function*(e){let[t,s]=e;return[t,(yield eV(s))]})))))})}(this.options.headers),this.options.params?function(e){return eu(this,null,function*(){let t=Object.entries(e);return Object.fromEntries((yield Promise.all(t.map(e=>eu(this,[e],function*(e){let[t,s]=e;if(void 0===s)return[t,void 0];let i=yield eV(s);return[t,Array.isArray(i)?i.join(","):i]})))).filter(e=>{let[t,s]=e;return void 0!==s}))})}((r=this.options.params,Array.isArray(r.params)?en(ei({},r),{params:Object.fromEntries(r.params.map((e,t)=>[t+1,e]))}):r)):void 0]);c&&eG(c);let f=new URL(o);if(c){c.table&&eB(f,"table",c.table),c.where&&eB(f,"where",c.where),c.columns&&eB(f,"columns",c.columns),c.replica&&eB(f,"replica",c.replica),c.params&&eB(f,"params",c.params);let e=ei({},c);for(let[t,s]of(delete e.table,delete e.where,delete e.columns,delete e.replica,delete e.params,Object.entries(e)))eB(f,t,s)}f.searchParams.set(eH,eo(this,m)),eo(this,y)&&(eo(this,E)||f.searchParams.set(eA,"true"),f.searchParams.set(eM,eo(this,w))),eo(this,b)&&f.searchParams.set(e_,eo(this,b)),f.searchParams.sort(),eh(this,O,new AbortController),l&&(e=()=>{var e;null==(e=eo(this,O))||e.abort(l.reason)},l.addEventListener("abort",e,{once:!0}),l.aborted&&(null==(t=eo(this,O))||t.abort(l.reason)));try{n=yield eo(this,u).call(this,f.toString(),{signal:eo(this,O).signal,headers:h}),eh(this,g,!0)}catch(e){if((e instanceof ed||e instanceof ef)&&eo(this,O).signal.aborted&&eo(this,O).signal.reason===eL)continue;if(e instanceof ef)break;if(!(e instanceof ed))throw e;if(409==e.status){let t=e.headers[ej];ec(this,x,L).call(this,t),yield ec(this,x,A).call(this,e.json);continue}if(e.status>=400&&e.status<500)throw ec(this,x,H).call(this,e),e}finally{e&&l&&l.removeEventListener("abort",e),eh(this,O,void 0)}let{headers:p,status:k}=n,P=p.get(ej);P&&eh(this,b,P);let j=p.get(ex);j&&eh(this,m,j);let M=p.get("electric-cursor");M&&eh(this,w,M);let _=()=>{let e=p.get("electric-schema");return e?JSON.parse(e):{}};eh(this,S,null!=(s=eo(this,S))?s:_());let N=204===k?"[]":yield n.text();204===k&&eh(this,v,Date.now());let C=eo(this,d).parse(N,eo(this,S));C.length>0&&(a=C[C.length-1],eW(a)||"up-to-date"!==a.headers.control||(eh(this,v,Date.now()),eh(this,y,!0)),yield ec(this,x,A).call(this,C)),null==(i=eo(this,W))||i.call(this)}}catch(e){if(eh(this,c,e),eo(this,k)){let t=yield eo(this,k).call(this,e);"object"==typeof t&&(ec(this,x,L).call(this),"params"in t&&(this.options.params=t.params),"headers"in t&&(this.options.headers=t.headers),eh(this,p,!1),ec(this,x,M).call(this));return}throw e}finally{eh(this,g,!1),null==(n=eo(this,j))||n.call(this)}})},_=function(){return eu(this,null,function*(){return eo(this,P)||(eh(this,P,new Promise((e,t)=>{eh(this,W,e),eh(this,j,t)})),eo(this,P).finally(()=>{eh(this,P,void 0),eh(this,W,void 0),eh(this,j,void 0)})),eo(this,P)})},A=function(e){return eu(this,null,function*(){yield Promise.all(Array.from(eo(this,f).values()).map(t=>eu(this,[t],function*(t){let[s,i]=t;try{yield s(e)}catch(e){queueMicrotask(()=>{throw e})}})))})},H=function(e){eo(this,f).forEach(t=>{let[s,i]=t;null==i||i(e)})},L=function(e){eh(this,m,"-1"),eh(this,w,""),eh(this,b,e),eh(this,y,!1),eh(this,g,!1),eh(this,S,void 0)},ez.Replica={FULL:"full",DEFAULT:"default"},new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakSet;let e$=e=>new Uint8Array((e.startsWith("\\x")?e.slice(2):e).match(/.{1,2}/g).map(e=>parseInt(e,16))),eQ={bytea:e=>{let t=e$(e);return V.l1(t)}},eX={bytea:e=>()=>{let t=e$(e);return V.l1(t)}},eY={timestamptz:e=>new Date(e)};var eK=s(5347);class eZ extends B.g{get synced(){return this._synced}set synced(e){this._synced!==e&&(this._synced=e,this.emit("synced",[e]),this.emit("sync",[e]))}async loadSyncState(){if(!this.persistence)throw Error("Can't load sync state without persistence backend");let e=await this.persistence.get("operations_handle"),t=await this.persistence.get("operations_offset"),s=await this.persistence.get("awareness_handle"),i=await this.persistence.get("awareness_offset"),n=await this.persistence.get("last_synced_state_vector");this.lastSyncedStateVector=n,this.modifiedWhileOffline=void 0!==this.lastSyncedStateVector,this.resume={operations:{handle:e,offset:t},awareness:{handle:s,offset:i}},this.loaded=!0,this.shouldConnect&&this.connect()}destroy(){var e;this.disconnect(),this.doc.off("update",this.updateHandler),null===(e=this.awareness)||void 0===e||e.off("update",this.awarenessUpdateHandler),$.UG&&void 0!==eK&&eK.off("exit",this.exitHandler),super.destroy()}disconnect(){this.shouldConnect=!1,this.awareness&&this.connected&&(this.awarenessState=this.awareness.getLocalState(),G.Ag(this.awareness,Array.from(this.awareness.getStates().keys()).filter(e=>e!==this.doc.clientID),this),G.Ag(this.awareness,[this.doc.clientID],"local")),this.disconnectShapeHandler&&this.disconnectShapeHandler()}connect(){this.shouldConnect=!0,this.connected||this.operationsStream||this.setupShapeStream(),this.awareness&&null!==this.awarenessState&&(this.awareness.setLocalState(this.awarenessState),this.awarenessState=null)}sendOperation(e){if(!this.connected)return this.modifiedWhileOffline=!0,Promise.resolve();let t=J.Mf();z.lr(t,e);let s=(0,F.s3)(J._f(t));return fetch("/api/operation",{method:"POST",body:JSON.stringify({room:this.roomName,op:s})})}sendAwareness(e){let t=J.Mf();J.mP(t,G.xq(this.awareness,e));let s=(0,F.s3)(J._f(t));if(this.connected){let e=this.roomName;return fetch("/api/operation",{method:"POST",body:JSON.stringify({clientId:"".concat(this.doc.clientID),room:e,op:s})})}}setupShapeStream(){if(this.shouldConnect&&!this.operationsStream){this.connected=!1,this.synced=!1,console.log("Setting up shape stream ".concat(JSON.stringify(this.resume))),this.operationsStream=new ez({url:this.baseUrl,params:{table:"ydoc_operations",where:"room = '".concat(this.roomName,"'")},parser:eQ,subscribe:!0,...this.resume.operations}),this.awarenessStream=new ez({url:this.baseUrl,params:{where:"room = '".concat(this.roomName,"'"),table:"ydoc_awareness"},parser:{...eX,...eY},...this.resume.awareness});let e=(e,t,s)=>{var i,n;this.resume[e]={offset:t,handle:s},null===(i=this.persistence)||void 0===i||i.set("".concat(e,"_offset"),t),null===(n=this.persistence)||void 0===n||n.set("".concat(e,"_handle"),s)},t=this.operationsStream.subscribe(t=>{t.forEach(t=>{if(eW(t)&&t.value.op){let e=t.value.op,s=J.Mf();J.uE(s,0),z.zu(e,s,this.doc,this)}else if(!eW(t)&&"up-to-date"===t.headers.control){var s,i;this.synced=!0,(null===(s=this.operationsStream)||void 0===s?void 0:s.lastOffset)&&(null===(i=this.operationsStream)||void 0===i?void 0:i.shapeHandle)&&e("operations",this.operationsStream.lastOffset,this.operationsStream.shapeHandle)}})}),s=this.awarenessStream.subscribe(t=>{var s,i;let n=new Date(Date.now()-3e4);t.forEach(e=>{if(eW(e)&&e.value.op){if(e.value.updated<n)return;let t=e.value.op();G.oy(this.awareness,V.HN(t),this)}}),(null===(s=this.awarenessStream)||void 0===s?void 0:s.lastOffset)&&(null===(i=this.awarenessStream)||void 0===i?void 0:i.shapeHandle)&&e("awareness",this.awarenessStream.lastOffset,this.awarenessStream.shapeHandle)});this.disconnectShapeHandler=()=>{if(this.operationsStream=void 0,this.awarenessStream=void 0,this.connected){var e;this.lastSyncedStateVector=I.gJ(this.doc),null===(e=this.persistence)||void 0===e||e.set("last_synced_state_vector",this.lastSyncedStateVector),this.connected=!1,this.synced=!1,this.emit("status",[{status:"disconnected"}])}t(),s(),this.disconnectShapeHandler=void 0,this.emit("connection-close",[])};let i=this.operationsStream.subscribe(()=>{if(this.connected=!0,this.modifiedWhileOffline){let e=I.D$(this.doc,this.lastSyncedStateVector),t=J.Mf();z.lr(t,e),this.sendOperation(e).then(()=>{var e;this.lastSyncedStateVector=void 0,this.modifiedWhileOffline=!1,null===(e=this.persistence)||void 0===e||e.del("last_synced_state_vector"),this.emit("status",[{status:"connected"}])})}i()});this.emit("status",[{status:"connecting"}])}}constructor(e,t,s,i){var n;super(),this.resume={},this.awarenessState=null,this.baseUrl=e+"/v1/shape",this.roomName=t,this.doc=s,this.awareness=i.awareness,this.connected=!1,this._synced=!1,this.shouldConnect=null!==(n=i.connect)&&void 0!==n&&n,this.modifiedWhileOffline=!1,this.persistence=i.persistence,this.loaded=void 0===this.persistence,this.updateHandler=(e,t)=>{t!==this&&this.sendOperation(e)},this.doc.on("update",this.updateHandler),this.awareness&&(this.awarenessUpdateHandler=(e,t)=>{let{added:s,updated:i,removed:n}=e;if("local"===t){let e=s.concat(i).concat(n);this.sendAwareness(e)}},this.awareness.on("update",this.awarenessUpdateHandler)),$.UG&&void 0!==eK&&(this.exitHandler=()=>{eK.on("exit",()=>this.destroy())}),this.loaded?i.connect&&this.connect():this.loadSyncState()}}var e0=s(838),e1=s(2860),e3=s(2199),e4=s(3254),e2=s(6277),e5=s(5129);let e9="electric-demo",e6=[{color:"#30bced",light:"#30bced33"},{color:"#6eeb83",light:"#6eeb8333"},{color:"#ffbc42",light:"#ffbc4233"},{color:"#ecd444",light:"#ecd44433"},{color:"#ee6352",light:"#ee635233"},{color:"#9ac2c9",light:"#9ac2c933"}],e7=e6[e2.U7()%e6.length],e8=new I.QW,te=new G.GL(e8);null==te||te.setLocalStateField("user",{name:e7.color,color:e7.color,colorLight:e7.light});let tt=new eZ(new URL("/shape-proxy",null===(U=window)||void 0===U?void 0:U.location.origin).href,e9,e8,{connect:!0,awareness:te,persistence:new e5.H7(e9,e8)});function ts(){let e=(0,D.useRef)(null),[t,s]=(0,D.useState)("connected"),i=()=>{if(!tt)return;let e="connected"===t?"disconnected":"connected";s(e),"connected"===e?tt.connect():tt.disconnect()};return(0,D.useEffect)(()=>{var t;let s=e8.getText(e9),i=e0.yy.create({doc:s.toString(),extensions:[e3.$f.of([...T.Rr]),e1.Xy,(0,e4.eJ)(),e3.tk.lineWrapping,(0,q.Iv)(s,te)]}),n=new e3.tk({state:i,parent:null!==(t=e.current)&&void 0!==t?t:void 0});return()=>n.destroy()}),(0,R.jsxs)("div",{children:[(0,R.jsx)("form",{action:async()=>i(),children:(0,R.jsx)("button",{type:"submit",className:"button",name:"intent",value:"add",children:t})}),(0,R.jsxs)("p",{children:["This is a demo of ",(0,R.jsx)("a",{href:"https://github.com/yjs/yjs",children:"Yjs"})," using"," "," ",(0,R.jsx)("a",{href:"https://github.com/electric-sql/electric",children:"Electric"})," for syncing."]}),(0,R.jsx)("p",{children:"The content of this editor is shared with every client that visits this domain."}),(0,R.jsx)("div",{ref:e})]})}}},function(e){e.O(0,[390,548,541,147,498,744],function(){return e(e.s=6775)}),_N_E=e.O()}]);