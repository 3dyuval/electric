(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6856:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>d,originalPathname:()=>u,pages:()=>h,routeModule:()=>f,tree:()=>a}),r(2969),r(2871),r(22);var n=r(3479),i=r(3515),s=r(1490),l=r.n(s),o=r(8058),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(t,c);let a=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2969)),"/home/yuval/proj/electric/examples/yjs/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2871)),"/home/yuval/proj/electric/examples/yjs/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,22,23)),"next/dist/client/components/not-found-error"]}],h=["/home/yuval/proj/electric/examples/yjs/app/page.tsx"],u="/page",d={require:r,loadChunk:()=>Promise.resolve()},f=new n.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:a}})},5362:(e,t,r)=>{let n={fdaed28e8d036333af35f18eb108651e69a29cf6:()=>Promise.resolve().then(r.bind(r,2969)).then(e=>e.default)};async function i(e,...t){return(await n[e]()).apply(null,t)}e.exports={fdaed28e8d036333af35f18eb108651e69a29cf6:i.bind(null,"fdaed28e8d036333af35f18eb108651e69a29cf6")}},7463:(e,t,r)=>{Promise.resolve().then(r.bind(r,5455))},1959:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5106,23)),Promise.resolve().then(r.t.bind(r,1056,23)),Promise.resolve().then(r.t.bind(r,4211,23)),Promise.resolve().then(r.t.bind(r,2890,23)),Promise.resolve().then(r.t.bind(r,3939,23)),Promise.resolve().then(r.t.bind(r,4551,23))},9138:()=>{},5455:(e,t,r)=>{"use strict";let n;r.d(t,{default:()=>sj});var i,s,l,o,c,a,h,u,d,f,g,p,w,m,y,b,_,v,k,S,E,A,D,C,O,x,M,T,I,j,N,L,P,R,U,F,$=r(7570),W=r(8605);let q=()=>new Map,J=e=>{let t=q();return e.forEach((e,r)=>{t.set(r,e)}),t},B=(e,t,r)=>{let n=e.get(t);return void 0===n&&e.set(t,n=r()),n},V=(e,t)=>{for(let[r,n]of e)if(t(n,r))return!0;return!1},z=()=>new Set,G=e=>e[e.length-1],H=(e,t)=>{for(let r=0;r<t.length;r++)e.push(t[r])},K=Array.from,Y=Array.isArray;class X{constructor(){this._observers=q()}on(e,t){return B(this._observers,e,z).add(t),t}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return K((this._observers.get(e)||q()).values()).forEach(e=>e(...t))}destroy(){this._observers=q()}}let Q=Math.floor,Z=Math.abs,ee=(e,t)=>e<t?e:t,et=(e,t)=>e>t?e:t,er=e=>0!==e?e<0:1/e<0,en=Number.MAX_SAFE_INTEGER;Number.MIN_SAFE_INTEGER;let ei=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&Q(e)===e);Number.parseInt;let es=String.fromCharCode;String.fromCodePoint,es(65535);let el=e=>e.toLowerCase(),eo=/^\s*/g,ec=e=>e.replace(eo,""),ea=/([A-Z])/g,eh=(e,t)=>ec(e.replace(ea,e=>`${t}${el(e)}`)),eu="undefined"!=typeof TextEncoder?new TextEncoder:null,ed=eu?e=>eu.encode(e):e=>{let t=unescape(encodeURIComponent(e)),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.codePointAt(e);return n},ef="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});ef&&1===ef.decode(new Uint8Array).length&&(ef=null);class eg{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let ep=()=>new eg,ew=e=>{let t=e.cpos;for(let r=0;r<e.bufs.length;r++)t+=e.bufs[r].length;return t},em=e=>{let t=new Uint8Array(ew(e)),r=0;for(let n=0;n<e.bufs.length;n++){let i=e.bufs[n];t.set(i,r),r+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),r),t},ey=(e,t)=>{let r=e.cbuf.length;r-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*et(r,t)),e.cpos=0)},eb=(e,t)=>{let r=e.cbuf.length;e.cpos===r&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*r),e.cpos=0),e.cbuf[e.cpos++]=t},e_=(e,t)=>{for(;t>127;)eb(e,128|127&t),t=Q(t/128);eb(e,127&t)},ev=(e,t)=>{let r=er(t);for(r&&(t=-t),eb(e,(t>63?128:0)|(r?64:0)|63&t),t=Q(t/64);t>0;)eb(e,(t>127?128:0)|127&t),t=Q(t/128)},ek=new Uint8Array(3e4),eS=ek.length/3,eE=eu&&eu.encodeInto?(e,t)=>{if(t.length<eS){let r=eu.encodeInto(t,ek).written||0;e_(e,r);for(let t=0;t<r;t++)eb(e,ek[t])}else eD(e,ed(t))}:(e,t)=>{let r=unescape(encodeURIComponent(t)),n=r.length;e_(e,n);for(let t=0;t<n;t++)eb(e,r.codePointAt(t))},eA=(e,t)=>{let r=e.cbuf.length,n=e.cpos,i=ee(r-n,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),n),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(et(2*r,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},eD=(e,t)=>{e_(e,t.byteLength),eA(e,t)},eC=(e,t)=>{ey(e,t);let r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},eO=(e,t)=>eC(e,4).setFloat32(0,t,!1),ex=(e,t)=>eC(e,8).setFloat64(0,t,!1),eM=(e,t)=>eC(e,8).setBigInt64(0,t,!1),eT=new DataView(new ArrayBuffer(4)),eI=e=>(eT.setFloat32(0,e),eT.getFloat32(0)===e),ej=(e,t)=>{switch(typeof t){case"string":eb(e,119),eE(e,t);break;case"number":ei(t)&&2147483647>=Z(t)?(eb(e,125),ev(e,t)):eI(t)?(eb(e,124),eO(e,t)):(eb(e,123),ex(e,t));break;case"bigint":eb(e,122),eM(e,t);break;case"object":if(null===t)eb(e,126);else if(Y(t)){eb(e,117),e_(e,t.length);for(let r=0;r<t.length;r++)ej(e,t[r])}else if(t instanceof Uint8Array)eb(e,116),eD(e,t);else{eb(e,118);let r=Object.keys(t);e_(e,r.length);for(let n=0;n<r.length;n++){let i=r[n];eE(e,i),ej(e,t[i])}}break;case"boolean":eb(e,t?120:121);break;default:eb(e,127)}};class eN extends eg{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&e_(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}let eL=e=>{e.count>0&&(ev(e.encoder,1===e.count?e.s:-e.s),e.count>1&&e_(e.encoder,e.count-2))};class eP{constructor(){this.encoder=new eg,this.s=0,this.count=0}write(e){this.s===e?this.count++:(eL(this),this.count=1,this.s=e)}toUint8Array(){return eL(this),em(this.encoder)}}let eR=e=>{if(e.count>0){let t=2*e.diff+(1===e.count?0:1);ev(e.encoder,t),e.count>1&&e_(e.encoder,e.count-2)}};class eU{constructor(){this.encoder=new eg,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(eR(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return eR(this),em(this.encoder)}}class eF{constructor(){this.sarr=[],this.s="",this.lensE=new eP}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new eg;return this.sarr.push(this.s),this.s="",eE(e,this.sarr.join("")),eA(e,this.lensE.toUint8Array()),em(e)}}let e$=e=>Error(e),eW=()=>{throw e$("Method unimplemented")},eq=()=>{throw e$("Unexpected case")},eJ=e$("Unexpected end of array"),eB=e$("Integer out of Range");class eV{constructor(e){this.arr=e,this.pos=0}}let ez=e=>new eV(e),eG=e=>e.pos!==e.arr.length,eH=(e,t)=>{let r=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,r},eK=e=>eH(e,eX(e)),eY=e=>e.arr[e.pos++],eX=e=>{let t=0,r=1,n=e.arr.length;for(;e.pos<n;){let n=e.arr[e.pos++];if(t+=(127&n)*r,r*=128,n<128)return t;if(t>en)throw eB}throw eJ},eQ=e=>{let t=e.arr[e.pos++],r=63&t,n=64,i=(64&t)>0?-1:1;if((128&t)==0)return i*r;let s=e.arr.length;for(;e.pos<s;){if(r+=(127&(t=e.arr[e.pos++]))*n,n*=128,t<128)return i*r;if(r>en)throw eB}throw eJ},eZ=ef?e=>ef.decode(eK(e)):e=>{let t=eX(e);if(0===t)return"";{let r=String.fromCodePoint(eY(e));if(--t<100)for(;t--;)r+=String.fromCodePoint(eY(e));else for(;t>0;){let n=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+n);e.pos+=n,r+=String.fromCodePoint.apply(null,i),t-=n}return decodeURIComponent(escape(r))}},e0=(e,t)=>{let r=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,r},e1=[e=>void 0,e=>null,eQ,e=>e0(e,4).getFloat32(0,!1),e=>e0(e,8).getFloat64(0,!1),e=>e0(e,8).getBigInt64(0,!1),e=>!1,e=>!0,eZ,e=>{let t=eX(e),r={};for(let n=0;n<t;n++)r[eZ(e)]=e8(e);return r},e=>{let t=eX(e),r=[];for(let n=0;n<t;n++)r.push(e8(e));return r},eK],e8=e=>e1[127-eY(e)](e);class e2 extends eV{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),eG(this)?this.count=eX(this)+1:this.count=-1),this.count--,this.s}}class e3 extends eV{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=eQ(this);let e=er(this.s);this.count=1,e&&(this.s=-this.s,this.count=eX(this)+2)}return this.count--,this.s}}class e6 extends eV{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){let e=eQ(this);this.diff=Q(e/2),this.count=1,1&e&&(this.count=eX(this)+2)}return this.s+=this.diff,this.count--,this.s}}class e4{constructor(e){this.decoder=new e3(e),this.str=eZ(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}let e9=require("node:crypto");e9.webcrypto.subtle;let e5=e9.webcrypto.getRandomValues.bind(e9.webcrypto),e7=()=>e5(new Uint32Array(1))[0],te=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^e7()&15>>e/4).toString(16)),tt=e=>new Promise(e);Promise.all.bind(Promise);let tr=e=>void 0===e?null:e;class tn{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let ti=new tn;try{"undefined"!=typeof localStorage&&localStorage&&(ti=localStorage)}catch(e){}let ts=ti,tl=Object.assign,to=Object.keys,tc=(e,t)=>{for(let r in e)t(e[r],r)},ta=e=>to(e).length,th=e=>to(e).length,tu=e=>{for(let t in e)return!1;return!0},td=(e,t)=>{for(let r in e)if(!t(e[r],r))return!1;return!0},tf=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),tg=(e,t)=>e===t||th(e)===th(t)&&td(e,(e,r)=>(void 0!==e||tf(t,r))&&t[r]===e),tp=Object.freeze,tw=e=>{for(let t in e){let r=e[t];("object"==typeof r||"function"==typeof r)&&tw(e[t])}return tp(e)},tm=(e,t,r=0)=>{try{for(;r<e.length;r++)e[r](...t)}finally{r<e.length&&tm(e,t,r+1)}},ty=e=>e,tb=(e,t)=>e===t,t_=(e,t)=>{if(null==e||null==t)return tb(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;break;case Set:if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;break;case Map:if(e.size!==t.size)return!1;for(let r of e.keys())if(!t.has(r)||!t_(e.get(r),t.get(r)))return!1;break;case Object:if(ta(e)!==ta(t))return!1;for(let r in e)if(!tf(e,r)||!t_(e[r],t[r]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!t_(e[r],t[r]))return!1;break;default:return!1}return!0},tv="undefined"!=typeof process&&process.release&&/node|io\.js/.test(process.release.name)&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0),tk="undefined"!=typeof window&&"undefined"!=typeof document&&!tv;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let tS=[],tE=()=>{if(void 0===n){if(tv){n=q();let e=process.argv,t=null;for(let r=0;r<e.length;r++){let i=e[r];"-"===i[0]?(null!==t&&n.set(t,""),t=i):null!==t?(n.set(t,i),t=null):tS.push(i)}null!==t&&n.set(t,"")}else"object"==typeof location?(n=q(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,r]=e.split("=");n.set(`--${eh(t,"-")}`,r),n.set(`-${eh(t,"-")}`,r)}})):n=q()}return n},tA=e=>tE().has(e),tD=e=>tv?tr(process.env[e.toUpperCase().replaceAll("-","_")]):tr(ts.getItem(e)),tC=e=>tA("--"+e)||null!==tD(e);tC("production");let tO=tv&&["true","1","2"].includes(process.env.FORCE_COLOR)||!tA("--no-colors")&&!tC("no-color")&&(!tv||process.stdout.isTTY)&&(!tv||tA("--color")||null!==tD("COLORTERM")||(tD("TERM")||"").includes("color")),tx=e=>new Uint8Array(e),tM=e=>{let t=tx(e.byteLength);return t.set(e),t},tT=Symbol,tI=Date.now,tj=tT(),tN=tT(),tL=tT(),tP=tT(),tR=tT(),tU=tT(),tF=tT(),t$=tT(),tW=tT();tI();let tq={[tj]:"\x1b[1m",[tN]:"\x1b[2m",[tL]:"\x1b[34m",[tR]:"\x1b[32m",[tP]:"\x1b[37m",[tU]:"\x1b[31m",[tF]:"\x1b[35m",[t$]:"\x1b[38;5;208m",[tW]:"\x1b[0m"},tJ=tO?e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],r=[],n=0;for(;n<e.length;n++){let r=e[n],i=tq[r];if(void 0!==i)t.push(i);else{if(void 0===r)break;if(r.constructor===String||r.constructor===Number)t.push(r);else break}}for(n>0&&(t.push("\x1b[0m"),r.push(t.join("")));n<e.length;n++){let t=e[n];t instanceof Symbol||r.push(t)}return r}:e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],r=[],n=0;for(;n<e.length;n++){let r=e[n];if(void 0===r)break;if(r.constructor===String||r.constructor===Number)t.push(r);else if(r.constructor===Object)break}for(n>0&&r.push(t.join(""));n<e.length;n++){let t=e[n];t instanceof Symbol||r.push(t)}return r},tB=(...e)=>{console.log(...tJ(e))},tV=(...e)=>{console.warn(...tJ(e))},tz=e=>({[Symbol.iterator](){return this},next:e}),tG=(e,t)=>tz(()=>{let r;do r=e.next();while(!r.done&&!t(r.value));return r}),tH=(e,t)=>tz(()=>{let{done:r,value:n}=e.next();return{done:r,value:r?void 0:t(n)}});class tK{constructor(e,t){this.clock=e,this.len=t}}class tY{constructor(){this.clients=new Map}}let tX=(e,t,r)=>t.clients.forEach((t,n)=>{let i=e.doc.store.clients.get(n);for(let n=0;n<t.length;n++){let s=t[n];rV(e,i,s.clock,s.len,r)}}),tQ=(e,t)=>{let r=0,n=e.length-1;for(;r<=n;){let i=Q((r+n)/2),s=e[i],l=s.clock;if(l<=t){if(t<l+s.len)return i;r=i+1}else n=i-1}return null},tZ=(e,t)=>{let r=e.clients.get(t.client);return void 0!==r&&null!==tQ(r,t.clock)},t0=e=>{e.clients.forEach(e=>{let t,r;for(e.sort((e,t)=>e.clock-t.clock),t=1,r=1;t<e.length;t++){let n=e[r-1],i=e[t];n.clock+n.len>=i.clock?n.len=et(n.len,i.clock+i.len-n.clock):(r<t&&(e[r]=i),r++)}e.length=r})},t1=e=>{let t=new tY;for(let r=0;r<e.length;r++)e[r].clients.forEach((n,i)=>{if(!t.clients.has(i)){let s=n.slice();for(let t=r+1;t<e.length;t++)H(s,e[t].clients.get(i)||[]);t.clients.set(i,s)}});return t0(t),t},t8=(e,t,r,n)=>{B(e.clients,t,()=>[]).push(new tK(r,n))},t2=()=>new tY,t3=e=>{let t=t2();return e.clients.forEach((e,r)=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t];if(r.deleted){let i=r.id.clock,s=r.length;if(t+1<e.length)for(let r=e[t+1];t+1<e.length&&r.deleted;r=e[++t+1])s+=r.length;n.push(new tK(i,s))}}n.length>0&&t.clients.set(r,n)}),t},t6=(e,t)=>{e_(e.restEncoder,t.clients.size),K(t.clients.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{e.resetDsCurVal(),e_(e.restEncoder,t);let n=r.length;e_(e.restEncoder,n);for(let t=0;t<n;t++){let n=r[t];e.writeDsClock(n.clock),e.writeDsLen(n.len)}})},t4=e=>{let t=new tY,r=eX(e.restDecoder);for(let n=0;n<r;n++){e.resetDsCurVal();let r=eX(e.restDecoder),n=eX(e.restDecoder);if(n>0){let i=B(t.clients,r,()=>[]);for(let t=0;t<n;t++)i.push(new tK(e.readDsClock(),e.readDsLen()))}}return t},t9=(e,t,r)=>{let n=new tY,i=eX(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();let i=eX(e.restDecoder),s=eX(e.restDecoder),l=r.clients.get(i)||[],o=rR(r,i);for(let r=0;r<s;r++){let r=e.readDsClock(),s=r+e.readDsLen();if(r<o){o<s&&t8(n,i,o,s-o);let e=rF(l,r),c=l[e];for(!c.deleted&&c.id.clock<r&&(l.splice(e+1,0,iy(t,c,r-c.id.clock)),e++);e<l.length;)if((c=l[e++]).id.clock<s)c.deleted||(s<c.id.clock+c.length&&l.splice(e,0,iy(t,c,s-c.id.clock)),c.delete(t));else break}else t8(n,i,r,s-r)}}if(n.clients.size>0){let e=new rl;return e_(e.restEncoder,0),t6(e,n),e.toUint8Array()}return null};class t5 extends X{constructor({guid:e=te(),collectionid:t=null,gc:r=!0,gcFilter:n=()=>!0,meta:i=null,autoLoad:s=!1,shouldLoad:l=!0}={}){super(),this.gc=r,this.gcFilter=n,this.clientID=e7(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new rL,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=l,this.autoLoad=s,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=tt(e=>{this.on("load",()=>{this.isLoaded=!0,e(this)})});let o=()=>tt(e=>{let t=r=>{(void 0===r||!0===r)&&(this.off("sync",t),e())};this.on("sync",t)});this.on("sync",e=>{!1===e&&this.isSynced&&(this.whenSynced=o()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=o()}load(){let e=this._item;null===e||this.shouldLoad||rZ(e.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(K(this.subdocs).map(e=>e.guid))}transact(e,t=null){return rZ(this,e,t)}get(e,t=nf){let r=B(this.share,e,()=>{let e=new t;return e._integrate(this,null),e}),n=r.constructor;if(t!==nf&&n!==t){if(n===nf){let n=new t;n._map=r._map,r._map.forEach(e=>{for(;null!==e;e=e.left)e.parent=n}),n._start=r._start;for(let e=n._start;null!==e;e=e.right)e.parent=n;return n._length=r._length,this.share.set(e,n),n._integrate(this,null),n}throw Error(`Type with the name ${e} has already been defined with a different constructor`)}return r}getArray(e=""){return this.get(e,nj)}getText(e=""){return this.get(e,nQ)}getMap(e=""){return this.get(e,nL)}getXmlElement(e=""){return this.get(e,n1)}getXmlFragment(e=""){return this.get(e,n0)}toJSON(){let e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,K(this.subdocs).forEach(e=>e.destroy());let e=this._item;if(null!==e){this._item=null;let t=e.content;t.doc=new t5({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,rZ(e.parent.doc,r=>{let n=t.doc;e.deleted||r.subdocsAdded.add(n),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class t7{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return eX(this.restDecoder)}readDsLen(){return eX(this.restDecoder)}}class re extends t7{readLeftID(){return rM(eX(this.restDecoder),eX(this.restDecoder))}readRightID(){return rM(eX(this.restDecoder),eX(this.restDecoder))}readClient(){return eX(this.restDecoder)}readInfo(){return eY(this.restDecoder)}readString(){return eZ(this.restDecoder)}readParentInfo(){return 1===eX(this.restDecoder)}readTypeRef(){return eX(this.restDecoder)}readLen(){return eX(this.restDecoder)}readAny(){return e8(this.restDecoder)}readBuf(){return tM(eK(this.restDecoder))}readJSON(){return JSON.parse(eZ(this.restDecoder))}readKey(){return eZ(this.restDecoder)}}class rt{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=eX(this.restDecoder),this.dsCurrVal}readDsLen(){let e=eX(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class rr extends rt{constructor(e){super(e),this.keys=[],eX(e),this.keyClockDecoder=new e6(eK(e)),this.clientDecoder=new e3(eK(e)),this.leftClockDecoder=new e6(eK(e)),this.rightClockDecoder=new e6(eK(e)),this.infoDecoder=new e2(eK(e),eY),this.stringDecoder=new e4(eK(e)),this.parentInfoDecoder=new e2(eK(e),eY),this.typeRefDecoder=new e3(eK(e)),this.lenDecoder=new e3(eK(e))}readLeftID(){return new rO(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new rO(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return e8(this.restDecoder)}readBuf(){return eK(this.restDecoder)}readJSON(){return e8(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let e=this.stringDecoder.read();return this.keys.push(e),e}}}class rn{constructor(){this.restEncoder=ep()}toUint8Array(){return em(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){e_(this.restEncoder,e)}writeDsLen(e){e_(this.restEncoder,e)}}class ri extends rn{writeLeftID(e){e_(this.restEncoder,e.client),e_(this.restEncoder,e.clock)}writeRightID(e){e_(this.restEncoder,e.client),e_(this.restEncoder,e.clock)}writeClient(e){e_(this.restEncoder,e)}writeInfo(e){eb(this.restEncoder,e)}writeString(e){eE(this.restEncoder,e)}writeParentInfo(e){e_(this.restEncoder,e?1:0)}writeTypeRef(e){e_(this.restEncoder,e)}writeLen(e){e_(this.restEncoder,e)}writeAny(e){ej(this.restEncoder,e)}writeBuf(e){eD(this.restEncoder,e)}writeJSON(e){eE(this.restEncoder,JSON.stringify(e))}writeKey(e){eE(this.restEncoder,e)}}class rs{constructor(){this.restEncoder=ep(),this.dsCurrVal=0}toUint8Array(){return em(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,e_(this.restEncoder,t)}writeDsLen(e){0===e&&eq(),e_(this.restEncoder,e-1),this.dsCurrVal+=e}}class rl extends rs{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new eU,this.clientEncoder=new eP,this.leftClockEncoder=new eU,this.rightClockEncoder=new eU,this.infoEncoder=new eN(eb),this.stringEncoder=new eF,this.parentInfoEncoder=new eN(eb),this.typeRefEncoder=new eP,this.lenEncoder=new eP}toUint8Array(){let e=ep();return e_(e,0),eD(e,this.keyClockEncoder.toUint8Array()),eD(e,this.clientEncoder.toUint8Array()),eD(e,this.leftClockEncoder.toUint8Array()),eD(e,this.rightClockEncoder.toUint8Array()),eD(e,em(this.infoEncoder)),eD(e,this.stringEncoder.toUint8Array()),eD(e,em(this.parentInfoEncoder)),eD(e,this.typeRefEncoder.toUint8Array()),eD(e,this.lenEncoder.toUint8Array()),eA(e,em(this.restEncoder)),em(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){ej(this.restEncoder,e)}writeBuf(e){eD(this.restEncoder,e)}writeJSON(e){ej(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}let ro=(e,t,r,n)=>{n=et(n,t[0].id.clock);let i=rF(t,n);e_(e.restEncoder,t.length-i),e.writeClient(r),e_(e.restEncoder,n);let s=t[i];s.write(e,n-s.id.clock);for(let r=i+1;r<t.length;r++)t[r].write(e,0)},rc=(e,t,r)=>{let n=new Map;r.forEach((e,r)=>{rR(t,r)>e&&n.set(r,e)}),rP(t).forEach((e,t)=>{r.has(t)||n.set(t,0)}),e_(e.restEncoder,n.size),K(n.entries()).sort((e,t)=>t[0]-e[0]).forEach(([r,n])=>{ro(e,t.clients.get(r),r,n)})},ra=(e,t)=>{let r=q(),n=eX(e.restDecoder);for(let i=0;i<n;i++){let n=eX(e.restDecoder),i=Array(n),s=e.readClient(),l=eX(e.restDecoder);r.set(s,{i:0,refs:i});for(let r=0;r<n;r++){let n=e.readInfo();switch(31&n){case 0:{let t=e.readLen();i[r]=new n4(rM(s,l),t),l+=t;break}case 10:{let t=eX(e.restDecoder);i[r]=new ik(rM(s,l),t),l+=t;break}default:{let o=(192&n)==0,c=new ib(rM(s,l),null,(128&n)==128?e.readLeftID():null,null,(64&n)==64?e.readRightID():null,o?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,o&&(32&n)==32?e.readString():null,i_(e,n));i[r]=c,l+=c.length}}}}return r},rh=(e,t,r)=>{let n=[],i=K(r.keys()).sort((e,t)=>e-t);if(0===i.length)return null;let s=()=>{if(0===i.length)return null;let e=r.get(i[i.length-1]);for(;e.refs.length===e.i;){if(i.pop(),!(i.length>0))return null;e=r.get(i[i.length-1])}return e},l=s();if(null===l)return null;let o=new rL,c=new Map,a=(e,t)=>{let r=c.get(e);(null==r||r>t)&&c.set(e,t)},h=l.refs[l.i++],u=new Map,d=()=>{for(let e of n){let t=e.id.client,n=r.get(t);n?(n.i--,o.clients.set(t,n.refs.slice(n.i)),r.delete(t),n.i=0,n.refs=[]):o.clients.set(t,[e]),i=i.filter(e=>e!==t)}n.length=0};for(;;){if(h.constructor!==ik){let i=B(u,h.id.client,()=>rR(t,h.id.client))-h.id.clock;if(i<0)n.push(h),a(h.id.client,h.id.clock-1),d();else{let s=h.getMissing(e,t);if(null!==s){n.push(h);let e=r.get(s)||{refs:[],i:0};if(e.refs.length===e.i)a(s,rR(t,s)),d();else{h=e.refs[e.i++];continue}}else(0===i||i<h.length)&&(h.integrate(e,i),u.set(h.id.client,h.id.clock+h.length))}}if(n.length>0)h=n.pop();else if(null!==l&&l.i<l.refs.length)h=l.refs[l.i++];else{if(null===(l=s()))break;h=l.refs[l.i++]}}if(o.clients.size>0){let e=new rl;return rc(e,o,new Map),e_(e.restEncoder,0),{missing:c,update:e.toUint8Array()}}return null},ru=(e,t)=>rc(e,t.doc.store,t.beforeState),rd=(e,t,r,n=new rr(e))=>rZ(t,e=>{e.local=!1;let t=!1,r=e.doc,i=r.store,s=rh(e,i,ra(n,r)),l=i.pendingStructs;if(l){for(let[e,r]of l.missing)if(r<rR(i,e)){t=!0;break}if(s){for(let[e,t]of s.missing){let r=l.missing.get(e);(null==r||r>t)&&l.missing.set(e,t)}l.update=r3([l.update,s.update])}}else i.pendingStructs=s;let o=t9(n,e,i);if(i.pendingDs){let t=new rr(ez(i.pendingDs));eX(t.restDecoder);let r=t9(t,e,i);o&&r?i.pendingDs=r3([o,r]):i.pendingDs=o||r}else i.pendingDs=o;if(t){let t=i.pendingStructs.update;i.pendingStructs=null,rf(e.doc,t)}},r,!1),rf=(e,t,r,n=rr)=>{let i=ez(t);rd(i,e,r,new n(i))},rg=(e,t,r)=>rf(e,t,r,re),rp=(e,t,r=new Map)=>{rc(e,t.store,r),t6(e,t3(t.store))},rw=(e,t=new Uint8Array([0]),r=new rl)=>{rp(r,e,rb(t));let n=[r.toUint8Array()];if(e.store.pendingDs&&n.push(e.store.pendingDs),e.store.pendingStructs&&n.push(r6(e.store.pendingStructs.update,t)),n.length>1){if(r.constructor===ri)return r8(n.map((e,t)=>0===t?e:ne(e)));if(r.constructor===rl)return r3(n)}return n[0]},rm=(e,t)=>rw(e,t,new ri),ry=e=>{let t=new Map,r=eX(e.restDecoder);for(let n=0;n<r;n++){let r=eX(e.restDecoder),n=eX(e.restDecoder);t.set(r,n)}return t},rb=e=>ry(new t7(ez(e))),r_=(e,t)=>(e_(e.restEncoder,t.size),K(t.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{e_(e.restEncoder,t),e_(e.restEncoder,r)}),e),rv=(e,t)=>r_(e,rP(t.store)),rk=(e,t=new rs)=>(e instanceof Map?r_(t,e):rv(t,e),t.toUint8Array());class rS{constructor(){this.l=[]}}let rE=()=>new rS,rA=(e,t)=>e.l.push(t),rD=(e,t)=>{let r=e.l,n=r.length;e.l=r.filter(e=>t!==e),n===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},rC=(e,t,r)=>tm(e.l,[t,r]);class rO{constructor(e,t){this.client=e,this.clock=t}}let rx=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,rM=(e,t)=>new rO(e,t),rT=e=>{for(let[t,r]of e.doc.share.entries())if(r===e)return t;throw eq()};class rI{constructor(e,t){this.ds=e,this.sv=t}}new rI(t2(),new Map);let rj=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!tZ(t.ds,e.id),rN=(e,t)=>{let r=B(e.meta,rN,z),n=e.doc.store;r.has(t)||(t.sv.forEach((t,r)=>{t<rR(n,r)&&rq(e,rM(r,t))}),tX(e,t.ds,e=>{}),r.add(t))};class rL{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}let rP=e=>{let t=new Map;return e.clients.forEach((e,r)=>{let n=e[e.length-1];t.set(r,n.id.clock+n.length)}),t},rR=(e,t)=>{let r=e.clients.get(t);if(void 0===r)return 0;let n=r[r.length-1];return n.id.clock+n.length},rU=(e,t)=>{let r=e.clients.get(t.id.client);if(void 0===r)r=[],e.clients.set(t.id.client,r);else{let e=r[r.length-1];if(e.id.clock+e.length!==t.id.clock)throw eq()}r.push(t)},rF=(e,t)=>{let r=0,n=e.length-1,i=e[n],s=i.id.clock;if(s===t)return n;let l=Q(t/(s+i.length-1)*n);for(;r<=n;){if((s=(i=e[l]).id.clock)<=t){if(t<s+i.length)return l;r=l+1}else n=l-1;l=Q((r+n)/2)}throw eq()},r$=(e,t)=>{let r=e.clients.get(t.client);return r[rF(r,t.clock)]},rW=(e,t,r)=>{let n=rF(t,r),i=t[n];return i.id.clock<r&&i instanceof ib?(t.splice(n+1,0,iy(e,i,r-i.id.clock)),n+1):n},rq=(e,t)=>{let r=e.doc.store.clients.get(t.client);return r[rW(e,r,t.clock)]},rJ=(e,t,r)=>{let n=t.clients.get(r.client),i=rF(n,r.clock),s=n[i];return r.clock!==s.id.clock+s.length-1&&s.constructor!==n4&&n.splice(i+1,0,iy(e,s,r.clock-s.id.clock+1)),s},rB=(e,t,r)=>{let n=e.clients.get(t.id.client);n[rF(n,t.id.clock)]=r},rV=(e,t,r,n,i)=>{let s;if(0===n)return;let l=r+n,o=rW(e,t,r);do l<(s=t[o++]).id.clock+s.length&&rW(e,t,l),i(s);while(o<t.length&&t[o].id.clock<l)};class rz{constructor(e,t,r){this.doc=e,this.deleteSet=new tY,this.beforeState=rP(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}let rG=(e,t)=>!!(0!==t.deleteSet.clients.size||V(t.afterState,(e,r)=>t.beforeState.get(r)!==e))&&(t0(t.deleteSet),ru(e,t),t6(e,t.deleteSet),!0),rH=(e,t,r)=>{let n=t._item;(null===n||n.id.clock<(e.beforeState.get(n.id.client)||0)&&!n.deleted)&&B(e.changed,t,z).add(r)},rK=(e,t)=>{let r=e[t],n=e[t-1],i=t;for(;i>0;r=n,n=e[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof ib&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}let s=t-i;return s&&e.splice(t+1-s,s),s},rY=(e,t,r)=>{for(let[n,i]of e.clients.entries()){let e=t.clients.get(n);for(let n=i.length-1;n>=0;n--){let s=i[n],l=s.clock+s.len;for(let n=rF(e,s.clock),i=e[n];n<e.length&&i.id.clock<l;i=e[++n]){let i=e[n];if(s.clock+s.len<=i.id.clock)break;i instanceof ib&&i.deleted&&!i.keep&&r(i)&&i.gc(t,!1)}}}},rX=(e,t)=>{e.clients.forEach((e,r)=>{let n=t.clients.get(r);for(let t=e.length-1;t>=0;t--){let r=e[t],i=ee(n.length-1,1+rF(n,r.clock+r.len-1));for(let e=i,t=n[e];e>0&&t.id.clock>=r.clock;t=n[e])e-=1+rK(n,e)}})},rQ=(e,t)=>{if(t<e.length){let r=e[t],n=r.doc,i=n.store,s=r.deleteSet,l=r._mergeStructs;try{t0(s),r.afterState=rP(r.doc.store),n.emit("beforeObserverCalls",[r,n]);let e=[];r.changed.forEach((t,n)=>e.push(()=>{null!==n._item&&n._item.deleted||n._callObserver(r,t)})),e.push(()=>{r.changedParentTypes.forEach((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter(e=>null===e.target._item||!e.target._item.deleted)).forEach(e=>{e.currentTarget=t,e._path=null}),e.sort((e,t)=>e.path.length-t.path.length),rC(t._dEH,e,r))})}),e.push(()=>n.emit("afterTransaction",[r,n])),tm(e,[]),r._needFormattingCleanup&&nK(r)}finally{n.gc&&rY(s,i,n.gcFilter),rX(s,i),r.afterState.forEach((e,t)=>{let n=r.beforeState.get(t)||0;if(n!==e){let e=i.clients.get(t),r=et(rF(e,n),1);for(let t=e.length-1;t>=r;)t-=1+rK(e,t)}});for(let e=l.length-1;e>=0;e--){let{client:t,clock:r}=l[e].id,n=i.clients.get(t),s=rF(n,r);!(s+1<n.length&&rK(n,s+1)>1)&&s>0&&rK(n,s)}if(r.local||r.afterState.get(n.clientID)===r.beforeState.get(n.clientID)||(tB(t$,tj,"[yjs] ",tN,tU,"Changed the client-id because another client seems to be using it."),n.clientID=e7()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){let e=new ri;rG(e,r)&&n.emit("update",[e.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){let e=new rl;rG(e,r)&&n.emit("updateV2",[e.toUint8Array(),r.origin,n,r])}let{subdocsAdded:o,subdocsLoaded:c,subdocsRemoved:a}=r;(o.size>0||a.size>0||c.size>0)&&(o.forEach(e=>{e.clientID=n.clientID,null==e.collectionid&&(e.collectionid=n.collectionid),n.subdocs.add(e)}),a.forEach(e=>n.subdocs.delete(e)),n.emit("subdocs",[{loaded:c,added:o,removed:a},n,r]),a.forEach(e=>e.destroy())),e.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,e])):rQ(e,t+1)}}},rZ=(e,t,r=null,n=!0)=>{let i=e._transactionCleanups,s=!1,l=null;null===e._transaction&&(s=!0,e._transaction=new rz(e,r,n),i.push(e._transaction),1===i.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{l=t(e._transaction)}finally{if(s){let t=e._transaction===i[0];e._transaction=null,t&&rQ(i,0)}}return l};class r0{constructor(e,t){this.gen=function*(e){let t=eX(e.restDecoder);for(let r=0;r<t;r++){let t=eX(e.restDecoder),r=e.readClient(),n=eX(e.restDecoder);for(let i=0;i<t;i++){let t=e.readInfo();if(10===t){let t=eX(e.restDecoder);yield new ik(rM(r,n),t),n+=t}else if((31&t)!=0){let i=(192&t)==0,s=new ib(rM(r,n),null,(128&t)==128?e.readLeftID():null,null,(64&t)==64?e.readRightID():null,i?e.readParentInfo()?e.readString():e.readLeftID():null,i&&(32&t)==32?e.readString():null,i_(e,t));yield s,n+=s.length}else{let t=e.readLen();yield new n4(rM(r,n),t),n+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===ik);return this.curr}}class r1{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}let r8=e=>r3(e,re,ri),r2=(e,t)=>{if(e.constructor===n4){let{client:r,clock:n}=e.id;return new n4(rM(r,n+t),e.length-t)}if(e.constructor===ik){let{client:r,clock:n}=e.id;return new ik(rM(r,n+t),e.length-t)}{let{client:r,clock:n}=e.id;return new ib(rM(r,n+t),null,rM(r,n+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},r3=(e,t=rr,r=rl)=>{if(1===e.length)return e[0];let n=e.map(e=>new t(ez(e))),i=n.map(e=>new r0(e,!0)),s=null,l=new r,o=new r1(l);for(;(i=i.filter(e=>null!==e.curr)).sort((e,t)=>{if(e.curr.id.client!==t.curr.id.client)return t.curr.id.client-e.curr.id.client;{let r=e.curr.id.clock-t.curr.id.clock;return 0===r?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===ik?1:-1:r}}),0!==i.length;){let e=i[0],t=e.curr.id.client;if(null!==s){let r=e.curr,n=!1;for(;null!==r&&r.id.clock+r.length<=s.struct.id.clock+s.struct.length&&r.id.client>=s.struct.id.client;)r=e.next(),n=!0;if(null===r||r.id.client!==t||n&&r.id.clock>s.struct.id.clock+s.struct.length)continue;if(t!==s.struct.id.client)r9(o,s.struct,s.offset),s={struct:r,offset:0},e.next();else if(s.struct.id.clock+s.struct.length<r.id.clock){if(s.struct.constructor===ik)s.struct.length=r.id.clock+r.length-s.struct.id.clock;else{r9(o,s.struct,s.offset);let e=r.id.clock-s.struct.id.clock-s.struct.length;s={struct:new ik(rM(t,s.struct.id.clock+s.struct.length),e),offset:0}}}else{let t=s.struct.id.clock+s.struct.length-r.id.clock;t>0&&(s.struct.constructor===ik?s.struct.length-=t:r=r2(r,t)),s.struct.mergeWith(r)||(r9(o,s.struct,s.offset),s={struct:r,offset:0},e.next())}}else s={struct:e.curr,offset:0},e.next();for(let r=e.curr;null!==r&&r.id.client===t&&r.id.clock===s.struct.id.clock+s.struct.length&&r.constructor!==ik;r=e.next())r9(o,s.struct,s.offset),s={struct:r,offset:0}}return null!==s&&(r9(o,s.struct,s.offset),s=null),r5(o),t6(l,t1(n.map(e=>t4(e)))),l.toUint8Array()},r6=(e,t,r=rr,n=rl)=>{let i=rb(t),s=new n,l=new r1(s),o=new r(ez(e)),c=new r0(o,!1);for(;c.curr;){let e=c.curr,t=e.id.client,r=i.get(t)||0;if(c.curr.constructor===ik){c.next();continue}if(e.id.clock+e.length>r)for(r9(l,e,et(r-e.id.clock,0)),c.next();c.curr&&c.curr.id.client===t;)r9(l,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===t&&c.curr.id.clock+c.curr.length<=r;)c.next()}return r5(l),t6(s,t4(o)),s.toUint8Array()},r4=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:em(e.encoder.restEncoder)}),e.encoder.restEncoder=ep(),e.written=0)},r9=(e,t,r)=>{e.written>0&&e.currClient!==t.id.client&&r4(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),e_(e.encoder.restEncoder,t.id.clock+r)),t.write(e.encoder,r),e.written++},r5=e=>{r4(e);let t=e.encoder.restEncoder;e_(t,e.clientStructs.length);for(let r=0;r<e.clientStructs.length;r++){let n=e.clientStructs[r];e_(t,n.written),eA(t,n.restEncoder)}},r7=(e,t,r,n)=>{let i=new r(ez(e)),s=new r0(i,!1),l=new n,o=new r1(l);for(let e=s.curr;null!==e;e=s.next())r9(o,t(e),0);return r5(o),t6(l,t4(i)),l.toUint8Array()},ne=e=>r7(e,ty,rr,ri),nt="You must not compute changes after the event-handler fired.";class nr{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=nn(this.currentTarget,this.target))}deletes(e){return tZ(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw e$(nt);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(r=>{if(null!==r){let n,i;let s=t._map.get(r);if(this.adds(s)){let e=s.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(s)){if(!(null!==e&&this.deletes(e)))return;n="delete",i=G(e.content.getContent())}else null!==e&&this.deletes(e)?(n="update",i=G(e.content.getContent())):(n="add",i=void 0)}else{if(!this.deletes(s))return;n="delete",i=G(s.content.getContent())}e.set(r,{action:n,oldValue:i})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw e$(nt);let t=this.target,r=z(),n=z(),i=[];if(e={added:r,deleted:n,delta:i,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null,s=()=>{e&&i.push(e)};for(let i=t._start;null!==i;i=i.right)i.deleted?this.deletes(i)&&!this.adds(i)&&((null===e||void 0===e.delete)&&(s(),e={delete:0}),e.delete+=i.length,n.add(i)):this.adds(i)?((null===e||void 0===e.insert)&&(s(),e={insert:[]}),e.insert=e.insert.concat(i.content.getContent()),r.add(i)):((null===e||void 0===e.retain)&&(s(),e={retain:0}),e.retain+=i.length);null!==e&&void 0===e.retain&&s()}this._changes=e}return e}}let nn=(e,t)=>{let r=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)r.unshift(t._item.parentSub);else{let e=0,n=t._item.parent._start;for(;n!==t._item&&null!==n;)!n.deleted&&n.countable&&(e+=n.length),n=n.right;r.unshift(e)}t=t._item.parent}return r},ni=()=>{tV("Invalid access: Add Yjs type to a document before reading data.")},ns=0;class nl{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=ns++}}let no=e=>{e.timestamp=ns++},nc=(e,t,r)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=r,e.timestamp=ns++},na=(e,t,r)=>{if(e.length>=80){let n=e.reduce((e,t)=>e.timestamp<t.timestamp?e:t);return nc(n,t,r),n}{let n=new nl(t,r);return e.push(n),n}},nh=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;let r=0===e._searchMarker.length?null:e._searchMarker.reduce((e,r)=>Z(t-e.index)<Z(t-r.index)?e:r),n=e._start,i=0;for(null!==r&&(n=r.p,i=r.index,no(r));null!==n.right&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;null!==n.left&&i>t;)!(n=n.left).deleted&&n.countable&&(i-=n.length);for(;null!==n.left&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)!(n=n.left).deleted&&n.countable&&(i-=n.length);return null!==r&&Z(r.index-i)<n.parent.length/80?(nc(r,n,i),r):na(e._searchMarker,n,i)},nu=(e,t,r)=>{for(let n=e.length-1;n>=0;n--){let i=e[n];if(r>0){let t=i.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)(t=t.left)&&!t.deleted&&t.countable&&(i.index-=t.length);if(null===t||!0===t.marker){e.splice(n,1);continue}i.p=t,t.marker=!0}(t<i.index||r>0&&t===i.index)&&(i.index=et(t,i.index+r))}},nd=(e,t,r)=>{let n=e,i=t.changedParentTypes;for(;B(i,e,()=>[]).push(r),null!==e._item;)e=e._item.parent;rC(n._eH,r,t)};class nf{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=rE(),this._dEH=rE(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw eW()}clone(){throw eW()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){rA(this._eH,e)}observeDeep(e){rA(this._dEH,e)}unobserve(e){rD(this._eH,e)}unobserveDeep(e){rD(this._dEH,e)}toJSON(){}}let ng=(e,t,r)=>{e.doc??ni(),t<0&&(t=e._length+t),r<0&&(r=e._length+r);let n=r-t,i=[],s=e._start;for(;null!==s&&n>0;){if(s.countable&&!s.deleted){let e=s.content.getContent();if(e.length<=t)t-=e.length;else{for(let r=t;r<e.length&&n>0;r++)i.push(e[r]),n--;t=0}}s=s.right}return i},np=e=>{e.doc??ni();let t=[],r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){let e=r.content.getContent();for(let r=0;r<e.length;r++)t.push(e[r])}r=r.right}return t},nw=(e,t)=>{let r=0,n=e._start;for(e.doc??ni();null!==n;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let n=0;n<i.length;n++)t(i[n],r++,e)}n=n.right}},nm=(e,t)=>{let r=[];return nw(e,(n,i)=>{r.push(t(n,i,e))}),r},ny=e=>{let t=e._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(null===r){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};r=t.content.getContent(),n=0,t=t.right}let e=r[n++];return r.length<=n&&(r=null),{done:!1,value:e}}}},nb=(e,t)=>{e.doc??ni();let r=nh(e,t),n=e._start;for(null!==r&&(n=r.p,t-=r.index);null!==n;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},n_=(e,t,r,n)=>{let i=r,s=e.doc,l=s.clientID,o=s.store,c=null===r?t._start:r.right,a=[],h=()=>{a.length>0&&((i=new ib(rM(l,rR(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new il(a))).integrate(e,0),a=[])};n.forEach(r=>{if(null===r)a.push(r);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:a.push(r);break;default:switch(h(),r.constructor){case Uint8Array:case ArrayBuffer:(i=new ib(rM(l,rR(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new n9(new Uint8Array(r)))).integrate(e,0);break;case t5:(i=new ib(rM(l,rR(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new ie(r))).integrate(e,0);break;default:if(r instanceof nf)(i=new ib(rM(l,rR(o,l)),i,i&&i.lastId,c,c&&c.id,t,null,new im(r))).integrate(e,0);else throw Error("Unexpected content type in insert operation")}}}),h()},nv=()=>e$("Length exceeded!"),nk=(e,t,r,n)=>{if(r>t._length)throw nv();if(0===r)return t._searchMarker&&nu(t._searchMarker,r,n.length),n_(e,t,null,n);let i=r,s=nh(t,r),l=t._start;for(null!==s&&(l=s.p,0==(r-=s.index)&&(r+=(l=l.prev)&&l.countable&&!l.deleted?l.length:0));null!==l;l=l.right)if(!l.deleted&&l.countable){if(r<=l.length){r<l.length&&rq(e,rM(l.id.client,l.id.clock+r));break}r-=l.length}return t._searchMarker&&nu(t._searchMarker,i,n.length),n_(e,t,l,n)},nS=(e,t,r)=>{let n=(t._searchMarker||[]).reduce((e,t)=>t.index>e.index?t:e,{index:0,p:t._start}).p;if(n)for(;n.right;)n=n.right;return n_(e,t,n,r)},nE=(e,t,r,n)=>{if(0===n)return;let i=r,s=n,l=nh(t,r),o=t._start;for(null!==l&&(o=l.p,r-=l.index);null!==o&&r>0;o=o.right)!o.deleted&&o.countable&&(r<o.length&&rq(e,rM(o.id.client,o.id.clock+r)),r-=o.length);for(;n>0&&null!==o;)o.deleted||(n<o.length&&rq(e,rM(o.id.client,o.id.clock+n)),o.delete(e),n-=o.length),o=o.right;if(n>0)throw nv();t._searchMarker&&nu(t._searchMarker,i,-s+n)},nA=(e,t,r)=>{let n=t._map.get(r);void 0!==n&&n.delete(e)},nD=(e,t,r,n)=>{let i;let s=t._map.get(r)||null,l=e.doc,o=l.clientID;if(null==n)i=new il([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:i=new il([n]);break;case Uint8Array:i=new n9(n);break;case t5:i=new ie(n);break;default:if(n instanceof nf)i=new im(n);else throw Error("Unexpected content type")}new ib(rM(o,rR(l.store,o)),s,s&&s.lastId,null,null,t,r,i).integrate(e,0)},nC=(e,t)=>{e.doc??ni();let r=e._map.get(t);return void 0===r||r.deleted?void 0:r.content.getContent()[r.length-1]},nO=e=>{let t={};return e.doc??ni(),e._map.forEach((e,r)=>{e.deleted||(t[r]=e.content.getContent()[e.length-1])}),t},nx=(e,t)=>{e.doc??ni();let r=e._map.get(t);return void 0!==r&&!r.deleted},nM=(e,t)=>{let r={};return e._map.forEach((e,n)=>{let i=e;for(;null!==i&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;null!==i&&rj(i,t)&&(r[n]=i.content.getContent()[i.length-1])}),r},nT=e=>(e.doc??ni(),tG(e._map.entries(),e=>!e[1].deleted));class nI extends nr{}class nj extends nf{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new nj;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new nj}clone(){let e=new nj;return e.insert(0,this.toArray().map(e=>e instanceof nf?e.clone():e)),e}get length(){return this.doc??ni(),this._length}_callObserver(e,t){super._callObserver(e,t),nd(this,e,new nI(this,e))}insert(e,t){null!==this.doc?rZ(this.doc,r=>{nk(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?rZ(this.doc,t=>{nS(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?rZ(this.doc,r=>{nE(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return nb(this,e)}toArray(){return np(this)}slice(e=0,t=this.length){return ng(this,e,t)}toJSON(){return this.map(e=>e instanceof nf?e.toJSON():e)}map(e){return nm(this,e)}forEach(e){nw(this,e)}[Symbol.iterator](){return ny(this)}_write(e){e.writeTypeRef(ia)}}class nN extends nr{constructor(e,t,r){super(e,t),this.keysChanged=r}}class nL extends nf{constructor(e){super(),this._prelimContent=null,void 0===e?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((e,t)=>{this.set(t,e)}),this._prelimContent=null}_copy(){return new nL}clone(){let e=new nL;return this.forEach((t,r)=>{e.set(r,t instanceof nf?t.clone():t)}),e}_callObserver(e,t){nd(this,e,new nN(this,e,t))}toJSON(){this.doc??ni();let e={};return this._map.forEach((t,r)=>{if(!t.deleted){let n=t.content.getContent()[t.length-1];e[r]=n instanceof nf?n.toJSON():n}}),e}get size(){return[...nT(this)].length}keys(){return tH(nT(this),e=>e[0])}values(){return tH(nT(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return tH(nT(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??ni(),this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?rZ(this.doc,t=>{nA(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?rZ(this.doc,r=>{nD(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return nC(this,e)}has(e){return nx(this,e)}clear(){null!==this.doc?rZ(this.doc,e=>{this.forEach(function(t,r,n){nA(e,n,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(ih)}}let nP=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&tg(e,t);class nR{constructor(e,t,r,n){this.left=e,this.right=t,this.index=r,this.currentAttributes=n}forward(){(null===this.right&&eq(),this.right.content.constructor===ir)?this.right.deleted||nW(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}let nU=(e,t,r)=>{for(;null!==t.right&&r>0;)t.right.content.constructor===ir?t.right.deleted||nW(t.currentAttributes,t.right.content):t.right.deleted||(r<t.right.length&&rq(e,rM(t.right.id.client,t.right.id.clock+r)),t.index+=t.right.length,r-=t.right.length),t.left=t.right,t.right=t.right.right;return t},nF=(e,t,r,n)=>{let i=new Map,s=n?nh(t,r):null;return s?nU(e,new nR(s.p.left,s.p,s.index,i),r-s.index):nU(e,new nR(null,t._start,0,i),r)},n$=(e,t,r,n)=>{for(;null!==r.right&&(!0===r.right.deleted||r.right.content.constructor===ir&&nP(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();let i=e.doc,s=i.clientID;n.forEach((n,l)=>{let o=r.left,c=r.right,a=new ib(rM(s,rR(i.store,s)),o,o&&o.lastId,c,c&&c.id,t,null,new ir(l,n));a.integrate(e,0),r.right=a,r.forward()})},nW=(e,t)=>{let{key:r,value:n}=t;null===n?e.delete(r):e.set(r,n)},nq=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===ir&&nP(t[e.right.content.key]??null,e.right.content.value));)e.forward()},nJ=(e,t,r,n)=>{let i=e.doc,s=i.clientID,l=new Map;for(let o in n){let c=n[o],a=r.currentAttributes.get(o)??null;if(!nP(a,c)){l.set(o,a);let{left:n,right:h}=r;r.right=new ib(rM(s,rR(i.store,s)),n,n&&n.lastId,h,h&&h.id,t,null,new ir(o,c)),r.right.integrate(e,0),r.forward()}}return l},nB=(e,t,r,n,i)=>{r.currentAttributes.forEach((e,t)=>{void 0===i[t]&&(i[t]=null)});let s=e.doc,l=s.clientID;nq(r,i);let o=nJ(e,t,r,i),c=n.constructor===String?new io(n):n instanceof nf?new im(n):new it(n),{left:a,right:h,index:u}=r;t._searchMarker&&nu(t._searchMarker,r.index,c.getLength()),(h=new ib(rM(l,rR(s.store,l)),a,a&&a.lastId,h,h&&h.id,t,null,c)).integrate(e,0),r.right=h,r.index=u,r.forward(),n$(e,t,r,o)},nV=(e,t,r,n,i)=>{let s=e.doc,l=s.clientID;nq(r,i);let o=nJ(e,t,r,i);for(;null!==r.right&&(n>0||o.size>0&&(r.right.deleted||r.right.content.constructor===ir));){if(!r.right.deleted){if(r.right.content.constructor===ir){let{key:t,value:s}=r.right.content,l=i[t];if(void 0!==l){if(nP(l,s))o.delete(t);else{if(0===n)break;o.set(t,s)}r.right.delete(e)}else r.currentAttributes.set(t,s)}else n<r.right.length&&rq(e,rM(r.right.id.client,r.right.id.clock+n)),n-=r.right.length}r.forward()}if(n>0){let i="";for(;n>0;n--)i+="\n";r.right=new ib(rM(l,rR(s.store,l)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,t,null,new io(i)),r.right.integrate(e,0),r.forward()}n$(e,t,r,o)},nz=(e,t,r,n,i)=>{let s=t,l=q();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===ir){let e=s.content;l.set(e.key,e)}s=s.right}let o=0,c=!1;for(;t!==s;){if(r===t&&(c=!0),!t.deleted){let r=t.content;if(r.constructor===ir){let{key:s,value:a}=r,h=n.get(s)??null;l.get(s)===r&&h!==a||(t.delete(e),o++,c||(i.get(s)??null)!==a||h===a||(null===h?i.delete(s):i.set(s,h))),c||t.deleted||nW(i,r)}}t=t.right}return o},nG=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let r=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===ir){let n=t.content.key;r.has(n)?t.delete(e):r.add(n)}t=t.left}},nH=e=>{let t=0;return rZ(e.doc,r=>{let n=e._start,i=e._start,s=q(),l=J(s);for(;i;)!1===i.deleted&&(i.content.constructor===ir?nW(l,i.content):(t+=nz(r,n,i,s,l),s=J(l),n=i)),i=i.right}),t},nK=e=>{let t=new Set,r=e.doc;for(let[n,i]of e.afterState.entries()){let s=e.beforeState.get(n)||0;i!==s&&rV(e,r.store.clients.get(n),s,i,e=>{e.deleted||e.content.constructor!==ir||e.constructor===n4||t.add(e.parent)})}rZ(r,r=>{for(let n of(tX(e,e.deleteSet,e=>{if(e instanceof n4||!e.parent._hasFormatting||t.has(e.parent))return;let n=e.parent;e.content.constructor===ir?t.add(n):nG(r,e)}),t))nH(n)})},nY=(e,t,r)=>{let n=r,i=J(t.currentAttributes),s=t.right;for(;r>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case im:case it:case io:r<t.right.length&&rq(e,rM(t.right.id.client,t.right.id.clock+r)),r-=t.right.length,t.right.delete(e)}t.forward()}s&&nz(e,s,t.right,i,t.currentAttributes);let l=(t.left||t.right).parent;return l._searchMarker&&nu(l._searchMarker,t.index,-n+r),t};class nX extends nr{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)})}get changes(){if(null===this._changes){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){let e=this.target.doc,t=[];rZ(e,e=>{let r=new Map,n=new Map,i=this.target._start,s=null,l={},o="",c=0,a=0,h=()=>{if(null!==s){let e=null;switch(s){case"delete":a>0&&(e={delete:a}),a=0;break;case"insert":("object"==typeof o||o.length>0)&&(e={insert:o},r.size>0&&(e.attributes={},r.forEach((t,r)=>{null!==t&&(e.attributes[r]=t)}))),o="";break;case"retain":c>0&&(e={retain:c},tu(l)||(e.attributes=tl({},l))),c=0}e&&t.push(e),s=null}};for(;null!==i;){switch(i.content.constructor){case im:case it:this.adds(i)?this.deletes(i)||(h(),s="insert",o=i.content.getContent()[0],h()):this.deletes(i)?("delete"!==s&&(h(),s="delete"),a+=1):i.deleted||("retain"!==s&&(h(),s="retain"),c+=1);break;case io:this.adds(i)?this.deletes(i)||("insert"!==s&&(h(),s="insert"),o+=i.content.str):this.deletes(i)?("delete"!==s&&(h(),s="delete"),a+=i.length):i.deleted||("retain"!==s&&(h(),s="retain"),c+=i.length);break;case ir:{let{key:t,value:o}=i.content;if(this.adds(i))this.deletes(i)||(nP(r.get(t)??null,o)?null!==o&&i.delete(e):("retain"===s&&h(),nP(o,n.get(t)??null)?delete l[t]:l[t]=o));else if(this.deletes(i)){n.set(t,o);let e=r.get(t)??null;nP(e,o)||("retain"===s&&h(),l[t]=e)}else if(!i.deleted){n.set(t,o);let r=l[t];void 0!==r&&(nP(r,o)?null!==r&&i.delete(e):("retain"===s&&h(),null===o?delete l[t]:l[t]=o))}i.deleted||("insert"===s&&h(),nW(r,i.content))}}i=i.right}for(h();t.length>0;){let e=t[t.length-1];if(void 0!==e.retain&&void 0===e.attributes)t.pop();else break}}),this._delta=t}return this._delta}}class nQ extends nf{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??ni(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(e=>e())}catch(e){console.error(e)}this._pending=null}_copy(){return new nQ}clone(){let e=new nQ;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let r=new nX(this,e,t);nd(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??ni();let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===io&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?rZ(this.doc,r=>{let n=new nR(null,this._start,0,new Map);for(let i=0;i<e.length;i++){let s=e[i];if(void 0!==s.insert){let l=t||"string"!=typeof s.insert||i!==e.length-1||null!==n.right||"\n"!==s.insert.slice(-1)?s.insert:s.insert.slice(0,-1);("string"!=typeof l||l.length>0)&&nB(r,this,n,l,s.attributes||{})}else void 0!==s.retain?nV(r,this,n,s.retain,s.attributes||{}):void 0!==s.delete&&nY(r,n,s.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){this.doc??ni();let n=[],i=new Map,s=this.doc,l="",o=this._start;function c(){if(l.length>0){let e={},t=!1;i.forEach((r,n)=>{t=!0,e[n]=r});let r={insert:l};t&&(r.attributes=e),n.push(r),l=""}}let a=()=>{for(;null!==o;){if(rj(o,e)||void 0!==t&&rj(o,t))switch(o.content.constructor){case io:{let n=i.get("ychange");void 0===e||rj(o,e)?void 0===t||rj(o,t)?void 0!==n&&(c(),i.delete("ychange")):(void 0===n||n.user!==o.id.client||"added"!==n.type)&&(c(),i.set("ychange",r?r("added",o.id):{type:"added"})):(void 0===n||n.user!==o.id.client||"removed"!==n.type)&&(c(),i.set("ychange",r?r("removed",o.id):{type:"removed"})),l+=o.content.str;break}case im:case it:{c();let e={insert:o.content.getContent()[0]};if(i.size>0){let t={};e.attributes=t,i.forEach((e,r)=>{t[r]=e})}n.push(e);break}case ir:rj(o,e)&&(c(),nW(i,o.content))}o=o.right}c()};return e||t?rZ(s,r=>{e&&rN(r,e),t&&rN(r,t),a()},"cleanup"):a(),n}insert(e,t,r){if(t.length<=0)return;let n=this.doc;null!==n?rZ(n,n=>{let i=nF(n,this,e,!r);r||(r={},i.currentAttributes.forEach((e,t)=>{r[t]=e})),nB(n,this,i,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){let n=this.doc;null!==n?rZ(n,n=>{let i=nF(n,this,e,!r);nB(n,this,i,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(0===t)return;let r=this.doc;null!==r?rZ(r,r=>{nY(r,nF(r,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(0===t)return;let n=this.doc;null!==n?rZ(n,n=>{let i=nF(n,this,e,!1);null!==i.right&&nV(n,this,i,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){null!==this.doc?rZ(this.doc,t=>{nA(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){null!==this.doc?rZ(this.doc,r=>{nD(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return nC(this,e)}getAttributes(){return nO(this)}_write(e){e.writeTypeRef(iu)}}class nZ{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??ni()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,e.deleted||t.constructor!==n1&&t.constructor!==n0||null===t._start)for(;null!==e;){if(null!==e.right){e=e.right;break}e=e.parent===this._root?null:e.parent._item}else e=t._start;while(null!==e&&(e.deleted||!this._filter(e.content.type)));return(this._firstCall=!1,null===e)?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class n0 extends nf{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new n0}clone(){let e=new n0;return e.insert(0,this.toArray().map(e=>e instanceof nf?e.clone():e)),e}get length(){return this.doc??ni(),null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new nZ(this,e)}querySelector(e){e=e.toUpperCase();let t=new nZ(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),K(new nZ(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){nd(this,e,new n8(this,t,e))}toString(){return nm(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){let n=e.createDocumentFragment();return void 0!==r&&r._createAssociation(n,this),nw(this,i=>{n.insertBefore(i.toDOM(e,t,r),null)}),n}insert(e,t){null!==this.doc?rZ(this.doc,r=>{nk(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)rZ(this.doc,r=>{n_(r,this,e&&e instanceof nf?e._item:e,t)});else{let r=this._prelimContent,n=null===e?0:r.findIndex(t=>t===e)+1;if(0===n&&null!==e)throw e$("Reference item not found");r.splice(n,0,...t)}}delete(e,t=1){null!==this.doc?rZ(this.doc,r=>{nE(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return np(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return nb(this,e)}slice(e=0,t=this.length){return ng(this,e,t)}forEach(e){nw(this,e)}_write(e){e.writeTypeRef(ig)}}class n1 extends n0{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((e,t)=>{this.setAttribute(t,e)}),this._prelimAttrs=null}_copy(){return new n1(this.nodeName)}clone(){let e=new n1(this.nodeName);return tc(this.getAttributes(),(t,r)=>{"string"==typeof t&&e.setAttribute(r,t)}),e.insert(0,this.toArray().map(e=>e instanceof nf?e.clone():e)),e}toString(){let e=this.getAttributes(),t=[],r=[];for(let t in e)r.push(t);r.sort();let n=r.length;for(let i=0;i<n;i++){let n=r[i];t.push(n+'="'+e[n]+'"')}let i=this.nodeName.toLocaleLowerCase(),s=t.length>0?" "+t.join(" "):"";return`<${i}${s}>${super.toString()}</${i}>`}removeAttribute(e){null!==this.doc?rZ(this.doc,t=>{nA(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?rZ(this.doc,r=>{nD(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return nC(this,e)}hasAttribute(e){return nx(this,e)}getAttributes(e){return e?nM(this,e):nO(this)}toDOM(e=document,t={},r){let n=e.createElement(this.nodeName),i=this.getAttributes();for(let e in i){let t=i[e];"string"==typeof t&&n.setAttribute(e,t)}return nw(this,i=>{n.appendChild(i.toDOM(e,t,r))}),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(id),e.writeKey(this.nodeName)}}class n8 extends nr{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)})}}class n2 extends nL{constructor(e){super(),this.hookName=e}_copy(){return new n2(this.hookName)}clone(){let e=new n2(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){let n;let i=t[this.hookName];return(n=void 0!==i?i.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(ip),e.writeKey(this.hookName)}}class n3 extends nQ{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new n3}clone(){let e=new n3;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){let n=e.createTextNode(this.toString());return void 0!==r&&r._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{let t=[];for(let r in e.attributes){let n=[];for(let t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort((e,t)=>e.key<t.key?-1:1),t.push({nodeName:r,attrs:n})}t.sort((e,t)=>e.nodeName<t.nodeName?-1:1);let r="";for(let e=0;e<t.length;e++){let n=t[e];r+=`<${n.nodeName}`;for(let e=0;e<n.attrs.length;e++){let t=n.attrs[e];r+=` ${t.key}="${t.value}"`}r+=">"}r+=e.insert;for(let e=t.length-1;e>=0;e--)r+=`</${t[e].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(iw)}}class n6{constructor(e,t){this.id=e,this.length=t}get deleted(){throw eW()}mergeWith(e){return!1}write(e,t,r){throw eW()}integrate(e,t){throw eW()}}class n4 extends n6{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),rU(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class n9{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new n9(this.content)}splice(e){throw eW()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class n5{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new n5(this.len)}splice(e){let t=new n5(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){t8(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}let n7=(e,t)=>new t5({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class ie{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new ie(n7(this.doc.guid,this.opts))}splice(e){throw eW()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class it{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new it(this.embed)}splice(e){throw eW()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class ir{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new ir(this.key,this.value)}splice(e){throw eW()}mergeWith(e){return!1}integrate(e,t){let r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class ii{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ii(this.arr)}splice(e){let t=new ii(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}let is="development"===tD("node_env");class il{constructor(e){this.arr=e,is&&tw(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new il(this.arr)}splice(e){let t=new il(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeAny(t)}}getRef(){return 8}}class io{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new io(this.str)}splice(e){let t=new io(this.str.slice(e));this.str=this.str.slice(0,e);let r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}let ic=[e=>new nj,e=>new nL,e=>new nQ,e=>new n1(e.readKey()),e=>new n0,e=>new n2(e.readKey()),e=>new n3],ia=0,ih=1,iu=2,id=3,ig=4,ip=5,iw=6;class im{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new im(this.type._copy())}splice(e){throw eW()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(t=>{for(;null!==t;)t.gc(e,!0),t=t.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}let iy=(e,t,r)=>{let{client:n,clock:i}=t.id,s=new ib(rM(n,i+r),t,rM(n,i+r-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(r));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),null!==t.redone&&(s.redone=rM(t.redone.client,t.redone.clock+r)),t.right=s,null!==s.right&&(s.right.left=s),e._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),t.length=r,s};class ib extends n6{constructor(e,t,r,n,i,s,l,o){super(e,o.getLength()),this.origin=r,this.left=t,this.right=n,this.rightOrigin=i,this.parent=s,this.parentSub=l,this.redone=null,this.content=o,this.info=this.content.isCountable()?2:0}set marker(e){(8&this.info)>0!==e&&(this.info^=8)}get marker(){return(8&this.info)>0}get keep(){return(1&this.info)>0}set keep(e){this.keep!==e&&(this.info^=1)}get countable(){return(2&this.info)>0}get deleted(){return(4&this.info)>0}set deleted(e){this.deleted!==e&&(this.info^=4)}markDeleted(){this.info|=4}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=rR(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=rR(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===rO&&this.id.client!==this.parent.client&&this.parent.clock>=rR(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=rJ(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=rq(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===n4||this.right&&this.right.constructor===n4)this.parent=null;else if(this.parent){if(this.parent.constructor===rO){let e=r$(t,this.parent);e.constructor===n4?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===ib&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===ib&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=rJ(e,e.doc.store,rM(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,r=this.left;if(null!==r)t=r.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;let n=new Set,i=new Set;for(;null!==t&&t!==this.right;){if(i.add(t),n.add(t),rx(this.origin,t.origin)){if(t.id.client<this.id.client)r=t,n.clear();else if(rx(this.rightOrigin,t.rightOrigin))break}else if(null!==t.origin&&i.has(r$(e.doc.store,t.origin)))n.has(r$(e.doc.store,t.origin))||(r=t,n.clear());else break;t=t.right}this.left=r}if(null!==this.left){let e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),rU(e.doc.store,this),this.content.integrate(e,this),rH(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new n4(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:rM(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&rx(e.origin,this.lastId)&&this.right===e&&rx(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),t8(e.deleteSet,this.id.client,this.id.clock,this.length),rH(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw eq();this.content.gc(e),t?rB(e,this,new n4(this.id,this.length)):this.content=new n5(this.length)}write(e,t){let r=t>0?rM(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,i=this.parentSub,s=31&this.content.getRef()|(null===r?0:128)|(null===n?0:64)|(null===i?0:32);if(e.writeInfo(s),null!==r&&e.writeLeftID(r),null!==n&&e.writeRightID(n),null===r&&null===n){let t=this.parent;if(void 0!==t._item){let r=t._item;if(null===r){let r=rT(t);e.writeParentInfo(!0),e.writeString(r)}else e.writeParentInfo(!1),e.writeLeftID(r.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===rO?(e.writeParentInfo(!1),e.writeLeftID(t)):eq();null!==i&&e.writeString(i)}this.content.write(e,t)}}let i_=(e,t)=>iv[31&t](e),iv=[()=>{eq()},e=>new n5(e.readLen()),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++){let t=e.readString();"undefined"===t?r.push(void 0):r.push(JSON.parse(t))}return new ii(r)},e=>new n9(e.readBuf()),e=>new io(e.readString()),e=>new it(e.readJSON()),e=>new ir(e.readKey(),e.readJSON()),e=>new im(ic[e.readTypeRef()](e)),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++)r.push(e.readAny());return new il(r)},e=>new ie(n7(e.readString(),e.readAny())),()=>{eq()}];class ik extends n6{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){eq()}write(e,t){e.writeInfo(10),e_(e.restEncoder,this.length-t)}getMissing(e,t){return null}}let iS="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},iE="__ $YJS$ __";!0===iS[iE]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),iS[iE]=!0;let iA=(e,t,r)=>{e_(e,1),eD(e,rm(t,r))},iD=(e,t,r)=>iA(t,r,eK(e)),iC=(e,t,r)=>{try{rg(t,eK(e),r)}catch(e){console.error("Caught error while handling a Yjs update",e)}};var iO=Object.defineProperty,ix=Object.defineProperties,iM=Object.getOwnPropertyDescriptors,iT=Object.getOwnPropertySymbols,iI=Object.prototype.hasOwnProperty,ij=Object.prototype.propertyIsEnumerable,iN=e=>{throw TypeError(e)},iL=(e,t,r)=>t in e?iO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,iP=(e,t)=>{for(var r in t||(t={}))iI.call(t,r)&&iL(e,r,t[r]);if(iT)for(var r of iT(t))ij.call(t,r)&&iL(e,r,t[r]);return e},iR=(e,t)=>ix(e,iM(t)),iU=(e,t)=>{var r={};for(var n in e)iI.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&iT)for(var n of iT(e))0>t.indexOf(n)&&ij.call(e,n)&&(r[n]=e[n]);return r},iF=(e,t,r)=>t.has(e)||iN("Cannot "+r),i$=(e,t,r)=>(iF(e,t,"read from private field"),r?r.call(e):t.get(e)),iW=(e,t,r)=>t.has(e)?iN("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),iq=(e,t,r,n)=>(iF(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),iJ=(e,t,r)=>(iF(e,t,"access private method"),r),iB=(e,t,r)=>new Promise((n,i)=>{var s=e=>{try{o(r.next(e))}catch(e){i(e)}},l=e=>{try{o(r.throw(e))}catch(e){i(e)}},o=e=>e.done?n(e.value):Promise.resolve(e.value).then(s,l);o((r=r.apply(e,t)).next())}),iV=class e extends Error{constructor(e,t,r,n,i,s){super(s||`HTTP Error ${e} at ${i}: ${null!=t?t:JSON.stringify(r)}`),this.url=i,this.name="FetchError",this.status=e,this.text=t,this.json=r,this.headers=n}static fromResponse(t,r){return iB(this,null,function*(){let n,i;let s=t.status,l=Object.fromEntries([...t.headers.entries()]),o=t.headers.get("content-type");return o&&o.includes("application/json")?i=yield t.json():n=yield t.text(),new e(s,n,i,l,r)})}},iz=class extends Error{constructor(){super("Fetch with backoff aborted"),this.name="FetchBackoffAbortError"}},iG=class extends Error{constructor(){super("Invalid shape options: missing required url parameter"),this.name="MissingShapeUrlError"}},iH=class extends Error{constructor(){super("Invalid signal option. It must be an instance of AbortSignal."),this.name="InvalidSignalError"}},iK=class extends Error{constructor(){super("shapeHandle is required if this isn't an initial fetch (i.e. offset > -1)"),this.name="MissingShapeHandleError"}},iY=class extends Error{constructor(e){super(`Cannot use reserved Electric parameter names in custom params: ${e.join(", ")}`),this.name="ReservedParamError"}},iX=class extends Error{constructor(e){super(`Column "${null!=e?e:"unknown"}" does not allow NULL values`),this.name="ParserNullValueError"}},iQ=class extends Error{constructor(e,t){let r=`The response for the shape request to ${e} didn't include the following required headers:
`;t.forEach(e=>{r+=`- ${e}
`}),super(r+=`
This is often due to a proxy not setting CORS correctly so that all Electric headers can be read by the client.
For more information visit the troubleshooting guide: /docs/guides/troubleshooting/missing-headers`)}},iZ=e=>Number(e),i0=e=>JSON.parse(e),i1=e=>e,i8={int2:iZ,int4:iZ,int8:e=>BigInt(e),bool:e=>"true"===e||"t"===e,float4:iZ,float8:iZ,json:i0,jsonb:i0},i2=class{constructor(e){this.parser=iP(iP({},i8),e)}parse(e,t){return JSON.parse(e,(e,r)=>(("value"===e||"old_value"===e)&&"object"==typeof r&&null!==r&&Object.keys(r).forEach(e=>{r[e]=this.parseRow(e,r[e],t)}),r))}parseRow(e,t,r){var n;let i=r[e];if(!i)return t;let{type:s,dims:l}=i,o=iU(i,["type","dims"]),c=i3(null!=(n=this.parser[s])?n:i1,i,e);return l&&l>0?i3((e,t)=>{let r,n,i,s,l,o;return r=0,n=null,i="",s=!1,l=0,function e(t){let a=[];for(;r<t.length;r++){if(n=t[r],s)"\\"===n?i+=t[++r]:'"'===n?(a.push(c?c(i):i),i="",s='"'===t[r+1],l=r+2):i+=n;else if('"'===n)s=!0;else if("{"===n)l=++r,a.push(e(t));else if("}"===n){s=!1,l<r&&a.push(c?c(t.slice(l,r)):t.slice(l,r)),l=r+1;break}else","===n&&"}"!==o&&'"'!==o&&(a.push(c?c(t.slice(l,r)):t.slice(l,r)),l=r+1);o=n}return l<r&&a.push(c?c(t.slice(l,r+1)):t.slice(l,r+1)),a}(e)[0]},i,e)(t):c(t,o)}};function i3(e,t,r){var n;let i=!(null!=(n=t.not_null)&&n);return n=>{if(null===n||"NULL"===n){if(!i)throw new iX(null!=r?r:"unknown");return null}return e(n,t)}}var i6="electric-handle",i4="electric-offset",i9="cursor",i5="handle",i7="live",se="offset",st="force-disconnect-and-refresh",sr=[429],sn={initialDelay:100,maxDelay:1e4,multiplier:1.3},si={maxChunksToPrefetch:2},ss=["electric-offset","electric-handle"],sl=["electric-cursor"],so=["electric-schema"],sc=class{constructor(e){var t;iW(this,a),iW(this,i),iW(this,s),iW(this,l,new Map),iW(this,o),iW(this,c),iq(this,i,null!=(t=e.fetchClient)?t:(...e)=>fetch(...e)),iq(this,s,e.maxPrefetchedRequests),iq(this,o,e.url.toString()),iq(this,c,i$(this,o)),iJ(this,a,h).call(this,e.url,e.requestInit)}abort(){i$(this,l).forEach(([e,t])=>t.abort())}consume(...e){var t;let r=e[0].toString(),n=null==(t=i$(this,l).get(r))?void 0:t[0];if(n&&r===i$(this,o))return i$(this,l).delete(r),n.then(t=>{let n=sa(r,t);iq(this,o,n),i$(this,c)&&!i$(this,l).has(i$(this,c))&&iJ(this,a,h).call(this,i$(this,c),e[1])}).catch(()=>{}),n}};function sa(e,t){let r=t.headers.get(i6),n=t.headers.get(i4),i=t.headers.has("electric-up-to-date");if(!r||!n||i)return;let s=new URL(e);if(!s.searchParams.has(i7))return s.searchParams.set(i5,r),s.searchParams.set(se,n),s.searchParams.sort(),s.toString()}function sh(){}i=new WeakMap,s=new WeakMap,l=new WeakMap,o=new WeakMap,c=new WeakMap,a=new WeakSet,h=function(...e){var t,r;let n=e[0].toString();if(i$(this,l).size>=i$(this,s))return;let o=new AbortController;try{let{signal:s,cleanup:u}=function(e,t){let r=sh;if(t){if(t.aborted)e.abort();else{let n=()=>e.abort();t.addEventListener("abort",n,{once:!0,signal:e.signal}),r=()=>t.removeEventListener("abort",n)}}return{signal:e.signal,cleanup:r}}(o,null==(t=e[1])?void 0:t.signal),d=i$(this,i).call(this,n,iR(iP({},null!=(r=e[1])?r:{}),{signal:s}));i$(this,l).set(n,[d,o]),d.then(t=>{if(!t.ok||o.signal.aborted)return;let r=sa(n,t);if(!r||r===n){iq(this,c,void 0);return}return iq(this,c,r),iJ(this,a,h).call(this,r,e[1])}).catch(()=>{}).finally(u)}catch(e){}};var su=new Set([i9,i5,i7,se]);function sd(e){return iB(this,null,function*(){return"function"==typeof e?e():e})}var sf=class{constructor(e){var t,r,n;iW(this,x),iW(this,u,null),iW(this,d),iW(this,f),iW(this,g,new Map),iW(this,p,!1),iW(this,w),iW(this,m),iW(this,y),iW(this,b,!1),iW(this,_,!1),iW(this,v),iW(this,k),iW(this,S),iW(this,E),iW(this,A,!1),iW(this,D),iW(this,C),iW(this,O),this.options=iP({subscribe:!0},e),function(e){if(!e.url)throw new iG;if(e.signal&&!(e.signal instanceof AbortSignal))throw new iH;if(void 0!==e.offset&&"-1"!==e.offset&&!e.handle)throw new iK;sg(e.params)}(this.options),iq(this,w,null!=(t=this.options.offset)?t:"-1"),iq(this,m,""),iq(this,v,this.options.handle),iq(this,f,new i2(e.parser)),iq(this,S,this.options.onError);let i=function(e,t=sn){let{initialDelay:r,maxDelay:n,multiplier:i,debug:s=!1,onFailedAttempt:l}=t;return(...t)=>iB(this,null,function*(){var o;let c=t[0],a=t[1],h=r,u=0;for(;;)try{let r=yield e(...t);if(r.ok)return r;throw yield iV.fromResponse(r,c.toString())}catch(e){if(null==l||l(),null==(o=null==a?void 0:a.signal)?void 0:o.aborted)throw new iz;if(e instanceof iV&&!sr.includes(e.status)&&e.status>=400&&e.status<500)throw e;yield new Promise(e=>setTimeout(e,h)),h=Math.min(h*i,n),s&&(u++,console.log(`Retry attempt #${u} after ${h}ms`))}})}(null!=(r=e.fetchClient)?r:(...e)=>fetch(...e),iR(iP({},null!=(n=e.backoffOptions)?n:sn),{onFailedAttempt:()=>{var t,r;iq(this,_,!1),null==(r=null==(t=e.backoffOptions)?void 0:t.onFailedAttempt)||r.call(t)}}));iq(this,d,function(e){return(...t)=>iB(this,null,function*(){let r=yield e(...t);if(r.ok){let e=r.headers,n=[],i=t=>n.push(...t.filter(t=>!e.has(t)));i(ss);let s=t[0].toString(),l=new URL(s);if("true"===l.searchParams.get(i7)&&i(sl),l.searchParams.has(i7)&&"false"!==l.searchParams.get(i7)||i(so),n.length>0)throw new iQ(s,n)}return r})}(function(e,t=si){let r;let{maxChunksToPrefetch:n}=t;return(...t)=>iB(this,null,function*(){let i=t[0].toString(),s=null==r?void 0:r.consume(...t);if(s)return s;null==r||r.abort();let l=yield e(...t),o=sa(i,l);return o&&(r=new sc({fetchClient:e,maxPrefetchedRequests:n,url:o,requestInit:t[1]})),l})}(i)))}get shapeHandle(){return i$(this,v)}get error(){return i$(this,u)}get isUpToDate(){return i$(this,b)}get lastOffset(){return i$(this,w)}subscribe(e,t=()=>{}){let r=Math.random();return i$(this,g).set(r,[e,t]),i$(this,p)||iJ(this,x,M).call(this),()=>{i$(this,g).delete(r)}}unsubscribeAll(){i$(this,g).clear()}lastSyncedAt(){return i$(this,y)}lastSynced(){return void 0===i$(this,y)?1/0:Date.now()-i$(this,y)}isConnected(){return i$(this,_)}isLoading(){return!i$(this,b)}hasStarted(){return i$(this,p)}forceDisconnectAndRefresh(){return iB(this,null,function*(){var e,t;iq(this,A,!0),!i$(this,b)||(null==(e=i$(this,E))?void 0:e.signal.aborted)||null==(t=i$(this,E))||t.abort(st),yield iJ(this,x,T).call(this),iq(this,A,!1)})}};function sg(e){if(!e)return;let t=Object.keys(e).filter(e=>su.has(e));if(t.length>0)throw new iY(t)}function sp(e,t,r){if(void 0!==r&&null!=r){if("string"==typeof r)e.searchParams.set(t,r);else if("object"==typeof r)for(let[n,i]of Object.entries(r))e.searchParams.set(`${t}[${n}]`,i);else e.searchParams.set(t,r.toString())}}u=new WeakMap,d=new WeakMap,f=new WeakMap,g=new WeakMap,p=new WeakMap,w=new WeakMap,m=new WeakMap,y=new WeakMap,b=new WeakMap,_=new WeakMap,v=new WeakMap,k=new WeakMap,S=new WeakMap,E=new WeakMap,A=new WeakMap,D=new WeakMap,C=new WeakMap,O=new WeakMap,x=new WeakSet,M=function(){return iB(this,null,function*(){var e,t,r,n,i,s,l,o;if(i$(this,p))throw Error("Cannot start stream twice");iq(this,p,!0);try{for(;!(null==(e=this.options.signal)?void 0:e.aborted)&&!i$(this,b)||this.options.subscribe;){let e,i;let{url:c,signal:a}=this.options,[h,u]=yield Promise.all([function(e){return iB(this,null,function*(){if(!e)return{};let t=Object.entries(e);return Object.fromEntries((yield Promise.all(t.map(e=>iB(this,[e],function*([e,t]){return[e,(yield sd(t))]})))))})}(this.options.headers),this.options.params?function(e){return iB(this,null,function*(){let t=Object.entries(e);return Object.fromEntries((yield Promise.all(t.map(e=>iB(this,[e],function*([e,t]){if(void 0===t)return[e,void 0];let r=yield sd(t);return[e,Array.isArray(r)?r.join(","):r]})))).filter(([e,t])=>void 0!==t))})}((s=this.options.params,Array.isArray(s.params)?iR(iP({},s),{params:Object.fromEntries(s.params.map((e,t)=>[t+1,e]))}):s)):void 0]);u&&sg(u);let g=new URL(c);if(u){u.table&&sp(g,"table",u.table),u.where&&sp(g,"where",u.where),u.columns&&sp(g,"columns",u.columns),u.replica&&sp(g,"replica",u.replica),u.params&&sp(g,"params",u.params);let e=iP({},u);for(let[t,r]of(delete e.table,delete e.where,delete e.columns,delete e.replica,delete e.params,Object.entries(e)))sp(g,t,r)}g.searchParams.set(se,i$(this,w)),i$(this,b)&&(i$(this,A)||g.searchParams.set(i7,"true"),g.searchParams.set(i9,i$(this,m))),i$(this,v)&&g.searchParams.set(i5,i$(this,v)),g.searchParams.sort(),iq(this,E,new AbortController),a&&(e=()=>{var e;null==(e=i$(this,E))||e.abort(a.reason)},a.addEventListener("abort",e,{once:!0}),a.aborted&&(null==(t=i$(this,E))||t.abort(a.reason)));try{i=yield i$(this,d).call(this,g.toString(),{signal:i$(this,E).signal,headers:h}),iq(this,_,!0)}catch(e){if((e instanceof iV||e instanceof iz)&&i$(this,E).signal.aborted&&i$(this,E).signal.reason===st)continue;if(e instanceof iz)break;if(!(e instanceof iV))throw e;if(409==e.status){let t=e.headers[i6];iJ(this,x,N).call(this,t),yield iJ(this,x,I).call(this,e.json);continue}if(e.status>=400&&e.status<500)throw iJ(this,x,j).call(this,e),e}finally{e&&a&&a.removeEventListener("abort",e),iq(this,E,void 0)}let{headers:p,status:S}=i,D=p.get(i6);D&&iq(this,v,D);let O=p.get(i4);O&&iq(this,w,O);let M=p.get("electric-cursor");M&&iq(this,m,M);let T=()=>{let e=p.get("electric-schema");return e?JSON.parse(e):{}};iq(this,k,null!=(r=i$(this,k))?r:T());let L=204===S?"[]":yield i.text();204===S&&iq(this,y,Date.now());let P=i$(this,f).parse(L,i$(this,k));if(P.length>0){o=l=P[P.length-1],"key"in o||"up-to-date"!==l.headers.control||(iq(this,y,Date.now()),iq(this,b,!0)),yield iJ(this,x,I).call(this,P)}null==(n=i$(this,C))||n.call(this)}}catch(e){if(iq(this,u,e),i$(this,S)){let t=yield i$(this,S).call(this,e);"object"==typeof t&&(iJ(this,x,N).call(this),"params"in t&&(this.options.params=t.params),"headers"in t&&(this.options.headers=t.headers),iq(this,p,!1),iJ(this,x,M).call(this));return}throw e}finally{iq(this,_,!1),null==(i=i$(this,O))||i.call(this)}})},T=function(){return iB(this,null,function*(){return i$(this,D)||(iq(this,D,new Promise((e,t)=>{iq(this,C,e),iq(this,O,t)})),i$(this,D).finally(()=>{iq(this,D,void 0),iq(this,C,void 0),iq(this,O,void 0)})),i$(this,D)})},I=function(e){return iB(this,null,function*(){yield Promise.all(Array.from(i$(this,g).values()).map(t=>iB(this,[t],function*([t,r]){try{yield t(e)}catch(e){queueMicrotask(()=>{throw e})}})))})},j=function(e){i$(this,g).forEach(([t,r])=>{null==r||r(e)})},N=function(e){iq(this,w,"-1"),iq(this,m,""),iq(this,v,e),iq(this,b,!1),iq(this,_,!1),iq(this,k,void 0)},sf.Replica={FULL:"full",DEFAULT:"default"},new WeakMap,P=new WeakMap,R=new WeakMap,new WeakMap,new WeakSet;let sw=e=>new Uint8Array((e.startsWith(`\\x`)?e.slice(2):e).match(/.{1,2}/g).map(e=>parseInt(e,16))),sm=e=>tt((t,r)=>{e.onerror=e=>r(Error(e.target.error)),e.onsuccess=e=>t(e.target.result)}),sy=(e,t,r="readwrite")=>{let n=e.transaction(t,r);return t.map(e=>sC(n,e))},sb=(e,t)=>sm(e.count(t)),s_=(e,t)=>sm(e.delete(t)),sv=(e,t)=>sm(e.add(t)),sk=(e,t,r)=>sm(e.getAll(t,r)),sS=(e,t,r)=>{let n=null;return sD(e,t,e=>(n=e,!1),r).then(()=>n)},sE=(e,t=null)=>sS(e,t,"prev"),sA=(e,t)=>tt((r,n)=>{e.onerror=n,e.onsuccess=async e=>{let n=e.target.result;if(null===n||await t(n)===!1)return r();n.continue()}}),sD=(e,t,r,n="next")=>sA(e.openKeyCursor(t,n),e=>r(e.key)),sC=(e,t)=>e.objectStore(t),sO=(e,t)=>IDBKeyRange.upperBound(e,t),sx=(e,t)=>IDBKeyRange.lowerBound(e,t),sM=(e,t=()=>{},r=()=>{})=>{let[n]=sy(e.db,["updates"]);return sk(n,sx(e._dbref,!1)).then(i=>{e._destroyed||(t(n),rZ(e.doc,()=>{i.forEach(t=>rg(e.doc,t))},e,!1),r(n))}).then(()=>sE(n).then(t=>{e._dbref=t+1})).then(()=>sb(n).then(t=>{e._dbsize=t})).then(()=>n)},sT=[{color:"#30bced",light:"#30bced33"},{color:"#6eeb83",light:"#6eeb8333"},{color:"#ffbc42",light:"#ffbc4233"},{color:"#ecd444",light:"#ecd44433"},{color:"#ee6352",light:"#ee635233"},{color:"#9ac2c9",light:"#9ac2c933"}];sT[e7()%sT.length],new t5;let sI=void 0;function sj(){let e=(0,W.useRef)(null),[t,r]=(0,W.useState)("connected"),n=()=>{if(!sI)return;let e="connected"===t?"disconnected":"connected";r(e),"connected"===e?sI.connect():sI.disconnect()};return(0,$.jsxs)("div",{children:[$.jsx("form",{action:async()=>n(),children:$.jsx("button",{type:"submit",className:"button",name:"intent",value:"add",children:t})}),(0,$.jsxs)("p",{children:["This is a demo of ",$.jsx("a",{href:"https://github.com/yjs/yjs",children:"Yjs"})," using"," "," ",$.jsx("a",{href:"https://github.com/electric-sql/electric",children:"Electric"})," for syncing."]}),$.jsx("p",{children:"The content of this editor is shared with every client that visits this domain."}),$.jsx("div",{ref:e})]})}},2871:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s,metadata:()=>i});var n=r(6947);let i={title:"Yjs <> Electric",description:"Yjs synching with Electric"};function s({children:e}){return n.jsx("html",{lang:"en",children:n.jsx("body",{children:e})})}},2969:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var n=r(6947),i=r(3822);r(5809),r(9184);let s=(0,r(6685).createProxy)(String.raw`/home/yuval/proj/electric/examples/yjs/app/electric-editor.tsx#default`);var l=r(190);let o=async()=>n.jsx(s,{}),c=o;(0,l.h)([o]),(0,i.j)("fdaed28e8d036333af35f18eb108651e69a29cf6",o)},190:(e,t)=>{"use strict";function r(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"h",{enumerable:!0,get:function(){return r}})},3822:(e,t,r)=>{"use strict";Object.defineProperty(t,"j",{enumerable:!0,get:function(){return i}});let n=r(7559);function i(e,t){return(0,n.registerServerReference)(t,e,null)}},3166:(e,t,r)=>{"use strict";var n=r(9737),i={stream:!0},s=new Map;function l(e){var t=globalThis.__next_require__(e);return"function"!=typeof t.then||"fulfilled"===t.status?null:(t.then(function(e){t.status="fulfilled",t.value=e},function(e){t.status="rejected",t.reason=e}),t)}function o(){}var c=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Dispatcher,a=Symbol.for("react.element"),h=Symbol.for("react.lazy"),u=Symbol.iterator,d=Array.isArray,f=Object.getPrototypeOf,g=Object.prototype,p=new WeakMap;function w(e,t,r,n){var i=1,s=0,l=null;e=JSON.stringify(e,function e(o,c){if(null===c)return null;if("object"==typeof c){if("function"==typeof c.then){null===l&&(l=new FormData),s++;var a,h,w=i++;return c.then(function(n){n=JSON.stringify(n,e);var i=l;i.append(t+w,n),0==--s&&r(i)},function(e){n(e)}),"$@"+w.toString(16)}if(d(c))return c;if(c instanceof FormData){null===l&&(l=new FormData);var m=l,y=t+(o=i++)+"_";return c.forEach(function(e,t){m.append(y+t,e)}),"$K"+o.toString(16)}if(c instanceof Map)return c=JSON.stringify(Array.from(c),e),null===l&&(l=new FormData),o=i++,l.append(t+o,c),"$Q"+o.toString(16);if(c instanceof Set)return c=JSON.stringify(Array.from(c),e),null===l&&(l=new FormData),o=i++,l.append(t+o,c),"$W"+o.toString(16);if(null===(h=c)||"object"!=typeof h?null:"function"==typeof(h=u&&h[u]||h["@@iterator"])?h:null)return Array.from(c);if((o=f(c))!==g&&(null===o||null!==f(o)))throw Error("Only plain objects, and a few built-ins, can be passed to Server Actions. Classes or null prototypes are not supported.");return c}if("string"==typeof c)return"Z"===c[c.length-1]&&this[o]instanceof Date?"$D"+c:c="$"===c[0]?"$"+c:c;if("boolean"==typeof c)return c;if("number"==typeof c)return Number.isFinite(a=c)?0===a&&-1/0==1/a?"$-0":a:1/0===a?"$Infinity":-1/0===a?"$-Infinity":"$NaN";if(void 0===c)return"$undefined";if("function"==typeof c){if(void 0!==(c=p.get(c)))return c=JSON.stringify(c,e),null===l&&(l=new FormData),o=i++,l.set(t+o,c),"$F"+o.toString(16);throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if("symbol"==typeof c){if(Symbol.for(o=c.description)!==c)throw Error("Only global symbols received from Symbol.for(...) can be passed to Server Functions. The symbol Symbol.for("+c.description+") cannot be found among global symbols.");return"$S"+o}if("bigint"==typeof c)return"$n"+c.toString(10);throw Error("Type "+typeof c+" is not supported as an argument to a Server Function.")}),null===l?r(e):(l.set(t+"0",e),0===s&&r(l))}var m=new WeakMap;function y(e){var t=p.get(this);if(!t)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var r=null;if(null!==t.bound){if((r=m.get(t))||(n=t,l=new Promise(function(e,t){i=e,s=t}),w(n,"",function(e){if("string"==typeof e){var t=new FormData;t.append("0",e),e=t}l.status="fulfilled",l.value=e,i(e)},function(e){l.status="rejected",l.reason=e,s(e)}),r=l,m.set(t,r)),"rejected"===r.status)throw r.reason;if("fulfilled"!==r.status)throw r;t=r.value;var n,i,s,l,o=new FormData;t.forEach(function(t,r){o.append("$ACTION_"+e+":"+r,t)}),r=o,t="$ACTION_REF_"+e}else t="$ACTION_ID_"+t.id;return{name:t,method:"POST",encType:"multipart/form-data",data:r}}function b(e,t){var r=p.get(this);if(!r)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(r.id!==e)return!1;var n=r.bound;if(null===n)return 0===t;switch(n.status){case"fulfilled":return n.value.length===t;case"pending":throw n;case"rejected":throw n.reason;default:throw"string"!=typeof n.status&&(n.status="pending",n.then(function(e){n.status="fulfilled",n.value=e},function(e){n.status="rejected",n.reason=e})),n}}function _(e,t,r){Object.defineProperties(e,{$$FORM_ACTION:{value:void 0===r?y:function(){var e=p.get(this);if(!e)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var t=e.bound;return null===t&&(t=Promise.resolve([])),r(e.id,t)}},$$IS_SIGNATURE_EQUAL:{value:b},bind:{value:S}}),p.set(e,t)}var v=Function.prototype.bind,k=Array.prototype.slice;function S(){var e=v.apply(this,arguments),t=p.get(this);if(t){var r=k.call(arguments,1),n=null;n=null!==t.bound?Promise.resolve(t.bound).then(function(e){return e.concat(r)}):Promise.resolve(r),Object.defineProperties(e,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:b},bind:{value:S}}),p.set(e,{id:t.id,bound:n})}return e}function E(e,t,r,n){this.status=e,this.value=t,this.reason=r,this._response=n}function A(e){switch(e.status){case"resolved_model":I(e);break;case"resolved_module":j(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":throw e;default:throw e.reason}}function D(e,t){for(var r=0;r<e.length;r++)(0,e[r])(t)}function C(e,t,r){switch(e.status){case"fulfilled":D(t,e.value);break;case"pending":case"blocked":case"cyclic":e.value=t,e.reason=r;break;case"rejected":r&&D(r,e.reason)}}function O(e,t){if("pending"===e.status||"blocked"===e.status){var r=e.reason;e.status="rejected",e.reason=t,null!==r&&D(r,t)}}function x(e,t){if("pending"===e.status||"blocked"===e.status){var r=e.value,n=e.reason;e.status="resolved_module",e.value=t,null!==r&&(j(e),C(e,r,n))}}E.prototype=Object.create(Promise.prototype),E.prototype.then=function(e,t){switch(this.status){case"resolved_model":I(this);break;case"resolved_module":j(this)}switch(this.status){case"fulfilled":e(this.value);break;case"pending":case"blocked":case"cyclic":e&&(null===this.value&&(this.value=[]),this.value.push(e)),t&&(null===this.reason&&(this.reason=[]),this.reason.push(t));break;default:t(this.reason)}};var M=null,T=null;function I(e){var t=M,r=T;M=e,T=null;var n=e.value;e.status="cyclic",e.value=null,e.reason=null;try{var i=JSON.parse(n,e._response._fromJSON);if(null!==T&&0<T.deps)T.value=i,e.status="blocked",e.value=null,e.reason=null;else{var s=e.value;e.status="fulfilled",e.value=i,null!==s&&D(s,i)}}catch(t){e.status="rejected",e.reason=t}finally{M=t,T=r}}function j(e){try{var t=e.value,r=globalThis.__next_require__(t[0]);if(4===t.length&&"function"==typeof r.then){if("fulfilled"===r.status)r=r.value;else throw r.reason}var n="*"===t[2]?r:""===t[2]?r.__esModule?r.default:r:r[t[2]];e.status="fulfilled",e.value=n}catch(t){e.status="rejected",e.reason=t}}function N(e,t){e._chunks.forEach(function(e){"pending"===e.status&&O(e,t)})}function L(e,t){var r=e._chunks,n=r.get(t);return n||(n=new E("pending",null,null,e),r.set(t,n)),n}function P(e,t){if("resolved_model"===(e=L(e,t)).status&&I(e),"fulfilled"===e.status)return e.value;throw e.reason}function R(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function U(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function F(e){var t,r=e.ssrManifest.moduleMap;return(r={_bundlerConfig:r,_moduleLoading:e.ssrManifest.moduleLoading,_callServer:void 0!==U?U:R,_encodeFormAction:e.encodeFormAction,_nonce:e="string"==typeof e.nonce?e.nonce:void 0,_chunks:new Map,_stringDecoder:new TextDecoder,_fromJSON:null,_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]})._fromJSON=(t=r,function(e,r){return"string"==typeof r?function(e,t,r,n){if("$"===n[0]){if("$"===n)return a;switch(n[1]){case"$":return n.slice(1);case"L":return{$$typeof:h,_payload:e=L(e,t=parseInt(n.slice(2),16)),_init:A};case"@":if(2===n.length)return new Promise(function(){});return L(e,t=parseInt(n.slice(2),16));case"S":return Symbol.for(n.slice(2));case"F":return t=P(e,t=parseInt(n.slice(2),16)),function(e,t){function r(){var e=Array.prototype.slice.call(arguments),r=t.bound;return r?"fulfilled"===r.status?n(t.id,r.value.concat(e)):Promise.resolve(r).then(function(r){return n(t.id,r.concat(e))}):n(t.id,e)}var n=e._callServer;return _(r,t,e._encodeFormAction),r}(e,t);case"Q":return new Map(e=P(e,t=parseInt(n.slice(2),16)));case"W":return new Set(e=P(e,t=parseInt(n.slice(2),16)));case"I":return 1/0;case"-":return"$-0"===n?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(n.slice(2)));case"n":return BigInt(n.slice(2));default:switch((e=L(e,n=parseInt(n.slice(1),16))).status){case"resolved_model":I(e);break;case"resolved_module":j(e)}switch(e.status){case"fulfilled":return e.value;case"pending":case"blocked":case"cyclic":var i;return n=M,e.then(function(e,t,r,n){if(T){var i=T;n||i.deps++}else i=T={deps:n?0:1,value:null};return function(n){t[r]=n,i.deps--,0===i.deps&&"blocked"===e.status&&(n=e.value,e.status="fulfilled",e.value=i.value,null!==n&&D(n,i.value))}}(n,t,r,"cyclic"===e.status),(i=n,function(e){return O(i,e)})),null;default:throw e.reason}}}return n}(t,this,e,r):"object"==typeof r&&null!==r?e=r[0]===a?{$$typeof:a,type:r[1],key:r[2],ref:null,props:r[3],_owner:null}:r:r}),r}function $(e,t){function n(t){N(e,t)}var a=t.getReader();a.read().then(function t(h){var u=h.value;if(h.done)N(e,Error("Connection closed."));else{var d=0,f=e._rowState,g=e._rowID,p=e._rowTag,w=e._rowLength;h=e._buffer;for(var m=u.length;d<m;){var y=-1;switch(f){case 0:58===(y=u[d++])?f=1:g=g<<4|(96<y?y-87:y-48);continue;case 1:84===(f=u[d])?(p=f,f=2,d++):64<f&&91>f?(p=f,f=3,d++):(p=0,f=3);continue;case 2:44===(y=u[d++])?f=4:w=w<<4|(96<y?y-87:y-48);continue;case 3:y=u.indexOf(10,d);break;case 4:(y=d+w)>u.length&&(y=-1)}var b=u.byteOffset+d;if(-1<y){d=new Uint8Array(u.buffer,b,y-d),w=e,b=p;var _=w._stringDecoder;p="";for(var v=0;v<h.length;v++)p+=_.decode(h[v],i);switch(p+=_.decode(d),b){case 73:!function(e,t,n){var i=e._chunks,a=i.get(t);n=JSON.parse(n,e._fromJSON);var h=function(e,t){if(e){var r=e[t[0]];if(e=r[t[2]])r=e.name;else{if(!(e=r["*"]))throw Error('Could not find the module "'+t[0]+'" in the React SSR Manifest. This is probably a bug in the React Server Components bundler.');r=t[2]}return 4===t.length?[e.id,e.chunks,r,1]:[e.id,e.chunks,r]}return t}(e._bundlerConfig,n);if(function(e,t,r){if(null!==e)for(var n=1;n<t.length;n+=2){var i=c.current;if(i){var s=i.preinitScript,l=e.prefix+t[n],o=e.crossOrigin;o="string"==typeof o?"use-credentials"===o?o:"":void 0,s.call(i,l,{crossOrigin:o,nonce:r})}}}(e._moduleLoading,n[1],e._nonce),n=function(e){for(var t=e[1],n=[],i=0;i<t.length;){var c=t[i++];t[i++];var a=s.get(c);if(void 0===a){a=r.e(c),n.push(a);var h=s.set.bind(s,c,null);a.then(h,o),s.set(c,a)}else null!==a&&n.push(a)}return 4===e.length?0===n.length?l(e[0]):Promise.all(n).then(function(){return l(e[0])}):0<n.length?Promise.all(n):null}(h)){if(a){var u=a;u.status="blocked"}else u=new E("blocked",null,null,e),i.set(t,u);n.then(function(){return x(u,h)},function(e){return O(u,e)})}else a?x(a,h):i.set(t,new E("resolved_module",h,null,e))}(w,g,p);break;case 72:if(g=p[0],w=JSON.parse(p=p.slice(1),w._fromJSON),p=c.current)switch(g){case"D":p.prefetchDNS(w);break;case"C":"string"==typeof w?p.preconnect(w):p.preconnect(w[0],w[1]);break;case"L":g=w[0],d=w[1],3===w.length?p.preload(g,d,w[2]):p.preload(g,d);break;case"m":"string"==typeof w?p.preloadModule(w):p.preloadModule(w[0],w[1]);break;case"S":"string"==typeof w?p.preinitStyle(w):p.preinitStyle(w[0],0===w[1]?void 0:w[1],3===w.length?w[2]:void 0);break;case"X":"string"==typeof w?p.preinitScript(w):p.preinitScript(w[0],w[1]);break;case"M":"string"==typeof w?p.preinitModuleScript(w):p.preinitModuleScript(w[0],w[1])}break;case 69:d=(p=JSON.parse(p)).digest,(p=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.")).stack="Error: "+p.message,p.digest=d,(b=(d=w._chunks).get(g))?O(b,p):d.set(g,new E("rejected",null,p,w));break;case 84:w._chunks.set(g,new E("fulfilled",p,null,w));break;case 68:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");default:(b=(d=w._chunks).get(g))?(w=b,g=p,"pending"===w.status&&(p=w.value,d=w.reason,w.status="resolved_model",w.value=g,null!==p&&(I(w),C(w,p,d)))):d.set(g,new E("resolved_model",p,null,w))}d=y,3===f&&d++,w=g=p=f=0,h.length=0}else{u=new Uint8Array(u.buffer,b,u.byteLength-d),h.push(u),w-=u.byteLength;break}}return e._rowState=f,e._rowID=g,e._rowTag=p,e._rowLength=w,a.read().then(t).catch(n)}}).catch(n)}t.createFromFetch=function(e,t){var r=F(t);return e.then(function(e){$(r,e.body)},function(e){N(r,e)}),L(r,0)},t.createFromReadableStream=function(e,t){return $(t=F(t),e),L(t,0)},t.createServerReference=function(e){return function(e,t,r){function n(){var r=Array.prototype.slice.call(arguments);return t(e,r)}return _(n,{id:e,bound:null},r),n}(e,U)},t.encodeReply=function(e){return new Promise(function(t,r){w(e,"",t,r)})}},6002:(e,t,r)=>{"use strict";e.exports=r(3166)},2095:()=>{},1351:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DetachedPromise",{enumerable:!0,get:function(){return r}});class r{constructor(){let e,t;this.promise=new Promise((r,n)=>{e=r,t=n}),this.resolve=e,this.reject=t}}},8132:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{atLeastOneTask:function(){return i},scheduleImmediate:function(){return n},scheduleOnNextTick:function(){return r}});let r=e=>{Promise.resolve().then(()=>{process.nextTick(e)})},n=e=>{setImmediate(e)};function i(){return new Promise(e=>n(e))}},7511:(e,t)=>{"use strict";let r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{arrayBufferToString:function(){return s},decrypt:function(){return c},encrypt:function(){return o},generateEncryptionKeyBase64:function(){return a},getActionEncryptionKey:function(){return g},getClientReferenceManifestSingleton:function(){return f},getServerModuleMap:function(){return d},setReferenceManifestsSingleton:function(){return u},stringToUint8Array:function(){return l}});let i=null;function s(e){let t=new Uint8Array(e),r=t.byteLength;if(r<65535)return String.fromCharCode.apply(null,t);let n="";for(let e=0;e<r;e++)n+=String.fromCharCode(t[e]);return n}function l(e){let t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}function o(e,t,r){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,r)}function c(e,t,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r)}async function a(e){if(e&&void 0!==n)return n;i||(i=new Promise(async(e,t)=>{try{let t=await crypto.subtle.generateKey({name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),r=await crypto.subtle.exportKey("raw",t),n=btoa(s(r));e([t,n])}catch(e){t(e)}}));let[t,l]=await i;return r=t,e&&(n=l),l}let h=Symbol.for("next.server.action-manifests");function u({clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:r}){globalThis[h]={clientReferenceManifest:e,serverActionsManifest:t,serverModuleMap:r}}function d(){let e=globalThis[h];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.serverModuleMap}function f(){let e=globalThis[h];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");return e.clientReferenceManifest}async function g(){if(r)return r;let e=globalThis[h];if(!e)throw Error("Missing manifest for Server Actions. This is a bug in Next.js");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw Error("Missing encryption key for Server Actions");return r=await crypto.subtle.importKey("raw",l(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},5809:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{decryptActionBoundArgs:function(){return d},encryptActionBoundArgs:function(){return u}}),r(2095);let n=r(7559),i=r(6002),s=r(3053),l=r(7511),o=new TextEncoder,c=new TextDecoder;async function a(e,t){let r=await (0,l.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(t),i=n.slice(0,16),s=n.slice(16),o=c.decode(await (0,l.decrypt)(r,(0,l.stringToUint8Array)(i),(0,l.stringToUint8Array)(s)));if(!o.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return o.slice(e.length)}async function h(e,t){let r=await (0,l.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);crypto.getRandomValues(n);let i=(0,l.arrayBufferToString)(n.buffer),s=await (0,l.encrypt)(r,n,o.encode(e+t));return btoa(i+(0,l.arrayBufferToString)(s))}async function u(e,t){let r=(0,l.getClientReferenceManifestSingleton)(),i=await (0,s.streamToString)((0,n.renderToReadableStream)(t,r.clientModules));return await h(e,i)}async function d(e,t){let r=await a(e,await t),s=await (0,i.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(o.encode(r)),e.close()}}),{ssrManifest:{moduleLoading:{},moduleMap:{}}}),c=(0,l.getServerModuleMap)();return await (0,n.decodeReply)(await (0,i.encodeReply)(s),c)}},4693:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ENCODED_TAGS",{enumerable:!0,get:function(){return r}});let r={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])}}},3053:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{chainStreams:function(){return u},continueDynamicDataResume:function(){return E},continueDynamicHTMLResume:function(){return S},continueDynamicPrerender:function(){return v},continueFizzStream:function(){return _},continueStaticPrerender:function(){return k},createBufferedTransformStream:function(){return g},createRootLayoutValidatorStream:function(){return b},renderToInitialFizzStream:function(){return p},streamFromString:function(){return d},streamToString:function(){return f}});let n=r(8798),i=r(4442),s=r(1351),l=r(8132),o=r(4693),c=r(4979);function a(){}let h=new TextEncoder;function u(...e){if(0===e.length)throw Error("Invariant: chainStreams requires at least one stream");if(1===e.length)return e[0];let{readable:t,writable:r}=new TransformStream,n=e[0].pipeTo(r,{preventClose:!0}),i=1;for(;i<e.length-1;i++){let t=e[i];n=n.then(()=>t.pipeTo(r,{preventClose:!0}))}let s=e[i];return(n=n.then(()=>s.pipeTo(r))).catch(a),t}function d(e){return new ReadableStream({start(t){t.enqueue(h.encode(e)),t.close()}})}async function f(e){let t=new TextDecoder("utf-8",{fatal:!0}),r="";for await(let n of e)r+=t.decode(n,{stream:!0});return r+t.decode()}function g(){let e,t=[],r=0,n=n=>{if(e)return;let i=new s.DetachedPromise;e=i,(0,l.scheduleImmediate)(()=>{try{let e=new Uint8Array(r),i=0;for(let r=0;r<t.length;r++){let n=t[r];e.set(n,i),i+=n.byteLength}t.length=0,r=0,n.enqueue(e)}catch{}finally{e=void 0,i.resolve()}})};return new TransformStream({transform(e,i){t.push(e),r+=e.byteLength,n(i)},flush(){if(e)return e.promise}})}function p({ReactDOMServer:e,element:t,streamOptions:r}){return(0,n.getTracer)().trace(i.AppRenderSpan.renderToReadableStream,async()=>e.renderToReadableStream(t,r))}function w(e){let t=!1,r=!1,n=!1;return new TransformStream({async transform(i,s){if(n=!0,r){s.enqueue(i);return}let a=await e();if(t){if(a){let e=h.encode(a);s.enqueue(e)}s.enqueue(i),r=!0}else{let e=(0,c.indexOfUint8Array)(i,o.ENCODED_TAGS.CLOSED.HEAD);if(-1!==e){if(a){let t=h.encode(a),r=new Uint8Array(i.length+t.length);r.set(i.slice(0,e)),r.set(t,e),r.set(i.slice(e),e+t.length),s.enqueue(r)}else s.enqueue(i);r=!0,t=!0}}t?(0,l.scheduleImmediate)(()=>{r=!1}):s.enqueue(i)},async flush(t){if(n){let r=await e();r&&t.enqueue(h.encode(r))}}})}function m(e){let t=null,r=!1;async function n(n){if(t)return;let i=e.getReader();await (0,l.atLeastOneTask)();try{for(;;){let{done:e,value:t}=await i.read();if(e){r=!0;return}n.enqueue(t)}}catch(e){n.error(e)}}return new TransformStream({transform(e,r){r.enqueue(e),t||(t=n(r))},flush(e){if(!r)return t||n(e)}})}function y(e){let t=!1,r=h.encode(e);return new TransformStream({transform(n,i){if(t)return i.enqueue(n);let s=(0,c.indexOfUint8Array)(n,r);if(s>-1){if(t=!0,n.length===e.length)return;let r=n.slice(0,s);if(i.enqueue(r),n.length>e.length+s){let t=n.slice(s+e.length);i.enqueue(t)}}else i.enqueue(n)},flush(e){e.enqueue(r)}})}function b(){let e=!1,t=!1;return new TransformStream({async transform(r,n){!e&&(0,c.indexOfUint8Array)(r,o.ENCODED_TAGS.OPENING.HTML)>-1&&(e=!0),!t&&(0,c.indexOfUint8Array)(r,o.ENCODED_TAGS.OPENING.BODY)>-1&&(t=!0),n.enqueue(r)},flush(r){let n=[];e||n.push("html"),t||n.push("body"),n.length&&r.enqueue(h.encode(`<script>self.__next_root_layout_missing_tags=${JSON.stringify(n)}</script>`))}})}async function _(e,{suffix:t,inlinedDataStream:r,isStaticGeneration:n,getServerInsertedHTML:i,serverInsertedHTMLToHead:o,validateRootLayout:c}){let a="</body></html>",u=t?t.split(a,1)[0]:null;return n&&"allReady"in e&&await e.allReady,function(e,t){let r=e;for(let e of t)e&&(r=r.pipeThrough(e));return r}(e,[g(),i&&!o?new TransformStream({transform:async(e,t)=>{let r=await i();r&&t.enqueue(h.encode(r)),t.enqueue(e)}}):null,null!=u&&u.length>0?function(e){let t,r=!1,n=r=>{let n=new s.DetachedPromise;t=n,(0,l.scheduleImmediate)(()=>{try{r.enqueue(h.encode(e))}catch{}finally{t=void 0,n.resolve()}})};return new TransformStream({transform(e,t){t.enqueue(e),r||(r=!0,n(t))},flush(n){if(t)return t.promise;r||n.enqueue(h.encode(e))}})}(u):null,r?m(r):null,c?b():null,y(a),i&&o?w(i):null])}async function v(e,{getServerInsertedHTML:t}){return e.pipeThrough(g()).pipeThrough(new TransformStream({transform(e,t){(0,c.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,c.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.BODY)||(0,c.isEquivalentUint8Arrays)(e,o.ENCODED_TAGS.CLOSED.HTML)||(e=(0,c.removeFromUint8Array)(e,o.ENCODED_TAGS.CLOSED.BODY),e=(0,c.removeFromUint8Array)(e,o.ENCODED_TAGS.CLOSED.HTML),t.enqueue(e))}})).pipeThrough(w(t))}async function k(e,{inlinedDataStream:t,getServerInsertedHTML:r}){return e.pipeThrough(g()).pipeThrough(w(r)).pipeThrough(m(t)).pipeThrough(y("</body></html>"))}async function S(e,{inlinedDataStream:t,getServerInsertedHTML:r}){return e.pipeThrough(g()).pipeThrough(w(r)).pipeThrough(m(t)).pipeThrough(y("</body></html>"))}async function E(e,{inlinedDataStream:t}){return e.pipeThrough(m(t)).pipeThrough(y("</body></html>"))}},4979:(e,t)=>{"use strict";function r(e,t){if(0===t.length)return 0;if(0===e.length||t.length>e.length)return -1;for(let r=0;r<=e.length-t.length;r++){let n=!0;for(let i=0;i<t.length;i++)if(e[r+i]!==t[i]){n=!1;break}if(n)return r}return -1}function n(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function i(e,t){let n=r(e,t);if(0===n)return e.subarray(t.length);if(!(n>-1))return e;{let r=new Uint8Array(e.length-t.length);return r.set(e.slice(0,n)),r.set(e.slice(n+t.length),n),r}}Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{indexOfUint8Array:function(){return r},isEquivalentUint8Arrays:function(){return n},removeFromUint8Array:function(){return i}})}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[134,386],()=>r(6856));module.exports=n})();